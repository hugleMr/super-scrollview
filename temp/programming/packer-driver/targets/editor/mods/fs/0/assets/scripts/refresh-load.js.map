{"version":3,"sources":["file:///Users/stevejobs/Documents/GitHub/super-scrollview/assets/scripts/refresh-load.ts"],"names":["_decorator","Node","Tween","Vec3","Label","BaseMain","ccclass","property","RefreshLoad","onLoad","header","setScale","footer","onHeader","scrollView","event","progress","headerTween","to","scale","easing","start","stop","label","getComponentInChildren","stage","string","datas","length","action","scheduleOnce","layout","total","onFooter","footerTween","i","push","message"],"mappings":"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","sourcesContent":["\nimport { _decorator, Node, Tween, Vec3, Label } from 'cc';\nimport { BaseMain } from './baseMain';\nconst { ccclass, property } = _decorator;\n\n@ccclass('RefreshLoad')\nexport class RefreshLoad extends BaseMain {\n    @property(Node) header!: Node\n    @property(Node) footer!: Node\n    onLoad() {\n        this.header.setScale(new Vec3(1, 0, 1))\n        this.footer.setScale(new Vec3(1, 0, 1))\n    }\n    \n    private headerTween!: Tween<Node>\n    private footerTween!: Tween<Node>\n    onHeader(scrollView: any, event: any) {\n        if (event.progress > 2) {\n            if (!(this.header as any)['playing']) {\n                this.headerTween = new Tween(this.header!);\n                this.headerTween.to(0.518, {\n                    scale: new Vec3(1, 1, 1),\n                }, {\n                    easing: \"elasticOut\"\n                });\n                this.headerTween.start();\n                (this.header as any)['playing'] = true\n            }\n        } else {\n            this.headerTween?.stop();\n            (this.header as any)['playing'] = false\n            this.header.setScale(new Vec3(1, event.progress, 1))\n        }\n\n        let label = this.header.getComponentInChildren(Label)!\n        if (event.stage == \"touch\") {\n            label.string = \"↓ 继续下拉\"\n        }\n        if (event.stage == \"wait\") {\n            label.string = \"↑ 松开刷新\"\n        }\n        if (event.stage == \"lock\") {\n            label.string = this.datas.length == 0 ? \"没有数据\" : \"刷新中...\"\n        }\n        if (event.stage == 'release') {\n            label.string = \"\"\n        }\n        if (event.action) {\n            this.scheduleOnce(() => this.layout.total(this.datas.length), 1)\n        }\n    }\n    onFooter(scrollView: any, event: any) {\n        if (event.progress > 2) {\n            if (!(this.footer as any)['playing']) {\n                this.footerTween = new Tween(this.footer!);\n                this.footerTween.to(0.518, {\n                    scale: new Vec3(1, 1, 1),\n                }, {\n                    easing: \"elasticOut\"\n                });\n                this.footerTween.start();\n                (this.footer as any)['playing'] = true\n            }\n        } else {\n            this.footerTween?.stop();\n            (this.footer as any)['playing'] = false\n            this.footer.setScale(new Vec3(1, event.progress, 1))\n        }\n\n        let label = this.footer.getComponentInChildren(Label)!\n        if (event.stage == \"touch\") {\n            label.string = \"↑ 继续上拉\"\n        }\n        if (event.stage == \"wait\") {\n            label.string = \"↓ 松开加载\"\n        }\n        if (event.stage == \"lock\") {\n            label.string = \"加载中...\"\n        }\n        if (event.stage == 'release') {\n            label.string = \"\"\n        }\n        if (event.action) {\n            for (let i = 0; i < 4; i++) {\n                this.datas.push({\n                    message: `${this.datas.length}`\n                })\n            }\n            this.scheduleOnce(() => this.layout.total(this.datas.length), 1)\n        }\n    }\n}"]}