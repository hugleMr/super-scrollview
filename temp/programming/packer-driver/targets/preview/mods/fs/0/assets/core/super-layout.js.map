{"version":3,"sources":["file:///Users/stevejobs/Documents/GitHub/super-scrollview/assets/core/super-layout.ts"],"names":["_decorator","Component","Node","ccenum","UITransform","SystemEventType","director","Vec3","EventHandler","instantiate","Prefab","Size","Vec2","size","SuperScrollview","ccclass","property","requireComponent","EPSILON","Type","VerticalAxisDirection","HorizontalAxisDirection","ScrollDirection","SuperLayout","type","tooltip","visible","autoCenter","NONE","onLoad","transform","setContentSize","view","contentSize","node","setPosition","ZERO","Object","defineProperty","configurable","get","onEnable","addEventListener","onDisable","removeEventListener","total","count","createItems","created","offset","itemTotal","_itemTotal","refreshItems","scrollView","release","scrollToCenter","soonFinish","scrollToHeader","timeInSecond","headerOrFooter","vertical","verticalAxisDirection","TOP_TO_BOTTOM","viewHeaderBoundary","viewFooterBoundary","horizontalAxisDirection","LEFT_TO_RIGHT","scrollToIndex","scrollToFooter","fixedItemHeight","height","fixedItemWidth","width","index","boundary","reverse","isNaN","stopAutoScroll","child","children","find","item","isDownOffset","footerIndex","headerIndex","Math","abs","start","groupItemTotal","i","pushToFooter","pushToHeader","maxPrefabTotal","length","headerLoop","footerLoop","notifyRefreshItem","itemPos","getPosition","clone","y","getItemYMax","_uiProps","uiTransformComp","paddingTop","getItemYMin","paddingBottom","x","getItemXMin","paddingLeft","getItemXMax","paddingRight","worldPos","convertToWorldSpaceAR","localPos","convertToNodeSpaceAR","multiple","getCenterAnchor","centerPosition","multiply","add","scrollToAny","center","pos","anchor","centerAnchor","origin","anchorY","anchorX","findedPos","position","map","newLocalPos","subtract","centerTime","getItemSize","spacing","spacingX","accommodWidth","spacingY","accommodHeight","getScaleHeight","getScaleWidth","getStartX","viewStartPoint","getEndX","getStartY","getEndY","isAccommodateByTop","relative","max","isAccommodateByBottom","min","isAccommodateByLeft","isAccommodateByRight","getRelativeByLeft","getRelativeByRight","getRelativeByTop","getRelativeByBottom","setItemPosition","header","getVerticalRelativePosition","getHorizontalRelativePosition","isAccommodate","startIndex","startAutoScroll","gener","removeItems","_maxPrefabTotal","getGeneratorLength","prefab","footer","addChild","getScale","on","EventType","SIZE_CHANGED","onChildSize","TRANSFORM_CHANGED","onChildScale","selfHorW","viewHorW","exeGenerator","off","destroy","removeChild","onPositionChanged","affectedByScale","TransformBit","SCALE","__scale","scale","console","warn","setScale","equals","resetChilds","__size","prevItem","getUsedScaleValue","value","trans","prevLocation","location","scrollDirection","FOOTER","HEADER","isOfBoundary","prevPos","force","headerBoundary","pushToFooterHandler","footerBoundary","pushToHeaderHandler","setSiblingIndex","accommodate","target","emitEvents","refreshItemEvents","callback","params","result","generator","duration","Promise","resolve","reject","gen","execute","startTime","Date","getTime","iter","next","done","setTimeout","getDeltaTime","layoutType","VERTICAL","HORIZONTAL","key","centerNode","centerHeaderBoundary","centerFooterBoundary","_centerPosition","parent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,e,OAAAA,e;AAAiBC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,Y,OAAAA,Y;AAAcC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;AAClIC,MAAAA,e,oBAAAA,e;;;;;;;AACDC,MAAAA,O,GAAwCf,U,CAAxCe,O;AAASC,MAAAA,Q,GAA+BhB,U,CAA/BgB,Q;AAAUC,MAAAA,gB,GAAqBjB,U,CAArBiB,gB;AACrBC,MAAAA,O,GAAU,I;;iBACXC,I;AAAAA,QAAAA,I,CAAAA,I;AAAAA,QAAAA,I,CAAAA,I;SAAAA,I,KAAAA,I;;AAILhB,MAAAA,MAAM,CAACgB,IAAD,CAAN;;iBACKC,qB;AAAAA,QAAAA,qB,CAAAA,qB;AAAAA,QAAAA,qB,CAAAA,qB;SAAAA,qB,KAAAA,qB;;AAILjB,MAAAA,MAAM,CAACiB,qBAAD,CAAN;;iBACKC,uB;AAAAA,QAAAA,uB,CAAAA,uB;AAAAA,QAAAA,uB,CAAAA,uB;SAAAA,uB,KAAAA,uB;;AAILlB,MAAAA,MAAM,CAACkB,uBAAD,CAAN;;iBACKC,e;AAAAA,QAAAA,e,CAAAA,e;AAAAA,QAAAA,e,CAAAA,e;AAAAA,QAAAA,e,CAAAA,e;SAAAA,e,KAAAA,e;;6BAOQC,W,WAFZR,OAAO,CAAC,aAAD,C,UACPE,gBAAgB,CAACb,WAAD,C,UAEZY,QAAQ;AAAA;AAAA,6C,UACRA,QAAQ,CAACZ,WAAD,C,UACRY,QAAQ,CAAC;AAAEQ,QAAAA,IAAI,EAAEL;AAAR,OAAD,C,UACRH,QAAQ,CAAC;AAAEQ,QAAAA,IAAI,EAAEJ;AAAR,OAAD,C,UACRJ,QAAQ,CAAC;AAAEQ,QAAAA,IAAI,EAAEH;AAAR,OAAD,C,UACRL,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,UACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAACN,MAAD,C,WACRM,QAAQ,CAACR,YAAD,C,WACRQ,QAAQ,CAAC;AAAES,QAAAA,OAAO,EAAE;AAAX,OAAD,C,WACRT,QAAQ,CAAC;AACNS,QAAAA,OAAO,EAAE,WADH;AAENC,QAAAA,OAAO,EAAE,mBAAY;AAAE,iBAAQ,IAAD,CAAcC,UAArB;AAAiC;AAFlD,OAAD,C,WAIRX,QAAQ,CAAC;AACNQ,QAAAA,IAAI,EAAEtB,IADA;AAENuB,QAAAA,OAAO,EAAE,4BAFH;AAGNC,QAAAA,OAAO,EAAE,mBAAY;AAAE,iBAAQ,IAAD,CAAcC,UAArB;AAAiC;AAHlD,OAAD,C,WAKRX,QAAQ,CAAC;AACNQ,QAAAA,IAAI,EAAEZ,IADA;AAENa,QAAAA,OAAO,EAAE,iBAFH;AAGNC,QAAAA,OAAO,EAAE,mBAAY;AAAE,iBAAQ,IAAD,CAAcC,UAArB;AAAiC;AAHlD,OAAD,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4EAMkCL,eAAe,CAACM,I;;oEA2TnC,IAAIrB,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,C;;4EACU,C;;uEAGL,C;;;;;;;eAgC7BsB,M,GAAA,kBAAS;AAAA;AAAA;;AACL,kCAAKC,SAAL,oEAAgBC,cAAhB,CAA+B,KAAKC,IAAL,CAAUC,WAAzC;AACA,eAAKC,IAAL,CAAUC,WAAV,CAAsB5B,IAAI,CAAC6B,IAA3B;AACAC,UAAAA,MAAM,CAACC,cAAP,CAAsB,KAAKR,SAA3B,EAAsC,aAAtC,EAAqD;AACjDS,YAAAA,YAAY,EAAE,IADmC;AAEjDC,YAAAA,GAAG,EAAE;AAAA,qBAAM,MAAI,CAACP,WAAX;AAAA;AAF4C,WAArD;AAIH,S;;eACDQ,Q,GAAA,oBAAW;AACP,eAAKC,gBAAL;AACH,S;;eACDC,S,GAAA,qBAAY;AACR,eAAKC,mBAAL;AACH;AACD;;;eACMC,K;;;+EAAN,iBAAYC,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BACwB,KAAKC,WAAL,CAAiBD,KAAjB,CADxB;;AAAA;AACQE,oBAAAA,OADR;AAEQC,oBAAAA,MAFR,GAEiBH,KAAK,GAAG,KAAKI,SAF9B;AAGI,yBAAKC,UAAL,GAAkBL,KAAlB;;AACA,wBAAI,CAACE,OAAL,EAAc;AACV,2BAAKI,YAAL,CAAkBH,MAAlB;AACH;;AACD,yBAAKI,UAAL,CAAgBC,OAAhB;;AAPJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,W;;;;;;;;AASA;;;eACAC,c,GAAA,0BAAiB;AACb,eAAKC,UAAL;AACH;AACD;;;eACAC,c,GAAA,wBAAeC,YAAf,EAAsC;AAClC,cAAIC,cAAc,GAAG,CAArB;;AACA,cAAI,KAAKC,QAAT,EAAmB;AACf,gBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnEH,cAAAA,cAAc,GAAG,KAAKI,kBAAtB;AACH,aAFD,MAEO;AACHJ,cAAAA,cAAc,GAAG,KAAKK,kBAAtB;AACH;AACJ,WAND,MAMO;AACH,gBAAI,KAAKC,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvEP,cAAAA,cAAc,GAAG,KAAKI,kBAAtB;AACH,aAFD,MAEO;AACHJ,cAAAA,cAAc,GAAG,KAAKK,kBAAtB;AACH;AACJ;;AACD,eAAKG,aAAL,CAAmB,CAAnB,EAAsBT,YAAtB,EAAoC,IAAInD,IAAJ,CAASoD,cAAT,EAAyBA,cAAzB,CAApC;AACH;AACD;;;eACAS,c,GAAA,wBAAeV,YAAf,EAAsC;AAClC,cAAIC,cAAc,GAAG,CAArB;;AACA,cAAI,KAAKC,QAAT,EAAmB;AACf,gBAAI,KAAKS,eAAL,GAAuB,KAAKrC,IAAL,CAAUsC,MAArC,EAA6C;;AAC7C,gBAAI,KAAKT,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnEH,cAAAA,cAAc,GAAG,KAAKK,kBAAtB;AACH,aAFD,MAEO;AACHL,cAAAA,cAAc,GAAG,KAAKI,kBAAtB;AACH;AACJ,WAPD,MAOO;AACH,gBAAI,KAAKQ,cAAL,GAAsB,KAAKvC,IAAL,CAAUwC,KAApC,EAA2C;;AAC3C,gBAAI,KAAKP,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvEP,cAAAA,cAAc,GAAG,KAAKK,kBAAtB;AACH,aAFD,MAEO;AACHL,cAAAA,cAAc,GAAG,KAAKI,kBAAtB;AACH;AACJ;;AACD,eAAKI,aAAL,CAAmB,KAAKjB,SAAL,GAAiB,CAApC,EAAuCQ,YAAvC,EAAqD,IAAInD,IAAJ,CAASoD,cAAT,EAAyBA,cAAzB,CAArD,EAA+F,IAA/F;AACH;AACD;;;eACAQ,a,GAAA,uBAAcM,KAAd,EAA6Bf,YAA7B,EAAoDgB,QAApD,EAAqEC,OAArE,EAA+F;AAAA;;AAAA,cAA1BA,OAA0B;AAA1BA,YAAAA,OAA0B,GAAP,KAAO;AAAA;;AAC3F,cAAIC,KAAK,CAACH,KAAD,CAAL,IAAgBA,KAAK,GAAG,CAAxB,IAA6BA,KAAK,GAAG,KAAKvB,SAAL,GAAiB,CAA1D,EAA6D;AAC7D,eAAKG,UAAL,CAAgBwB,cAAhB;AACA,cAAI5B,MAAM,GAAG,CAAb;AACA,cAAI6B,KAAK,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBC,IAAnB,CAAwB,UAACC,IAAD;AAAA,mBAAeA,IAAI,CAAC,SAAD,CAAJ,IAAmBR,KAAlC;AAAA,WAAxB,CAAZ;;AACA,cAAI,CAACK,KAAL,EAAY;AACR,gBAAII,YAAY,GAAG,KAAnB;;AACA,gBAAIT,KAAK,GAAG,KAAKU,WAAb,IAA4BV,KAAK,GAAG,KAAKW,WAA7C,EAA0D;AACtD,kBAAIC,IAAI,CAACC,GAAL,CAASb,KAAK,GAAG,KAAKW,WAAtB,IAAqCC,IAAI,CAACC,GAAL,CAASb,KAAK,GAAG,KAAKU,WAAtB,CAAzC,EAA6E;AACzED,gBAAAA,YAAY,GAAG,KAAf;AACH,eAFD,MAEO;AACHA,gBAAAA,YAAY,GAAG,IAAf;AACH;AACJ,aAND,MAMO,IAAIT,KAAK,GAAG,KAAKU,WAAjB,EAA8B;AACjCD,cAAAA,YAAY,GAAG,IAAf;AACH,aAFM,MAEA,IAAIT,KAAK,GAAG,KAAKW,WAAjB,EAA8B;AACjCF,cAAAA,YAAY,GAAG,KAAf;AACH;;AACD,gBAAIK,KAAK,GAAG,CAAZ;;AACA,gBAAIL,YAAJ,EAAkB;AACdjC,cAAAA,MAAM,GAAGwB,KAAK,GAAG,KAAKe,cAAb,GAA8B,KAAKL,WAAL,GAAmB,KAAKK,cAA/D;AACAvC,cAAAA,MAAM,GAAGoC,IAAI,CAACC,GAAL,CAASrC,MAAT,CAAT;AACH,aAHD,MAGO;AACHA,cAAAA,MAAM,GAAG,KAAKmC,WAAL,GAAmB,KAAKI,cAAjC;AACAvC,cAAAA,MAAM,GAAGoC,IAAI,CAACC,GAAL,CAASrC,MAAT,CAAT;AACH;;AACD,iBAAK,IAAIwC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxC,MAApB,EAA4BwC,CAAC,EAA7B,EAAiC;AAC7B,kBAAI,KAAK7B,QAAT,EAAmB;AACf,oBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,sBAAIoB,YAAJ,EAAkB;AACd,yBAAKQ,YAAL,CAAkB,IAAlB;AACH,mBAFD,MAEO;AACH,yBAAKC,YAAL,CAAkB,IAAlB;AACH;AACJ,iBAND,MAMO;AACH,sBAAIT,YAAJ,EAAkB;AACd,yBAAKS,YAAL,CAAkB,IAAlB;AACH,mBAFD,MAEO;AACH,yBAAKD,YAAL,CAAkB,IAAlB;AACH;AACJ;AACJ,eAdD,MAcO;AACH,oBAAI,KAAKzB,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,sBAAIgB,YAAJ,EAAkB;AACd,yBAAKQ,YAAL,CAAkB,IAAlB;AACH,mBAFD,MAEO;AACH,yBAAKC,YAAL,CAAkB,IAAlB;AACH;AACJ,iBAND,MAMO;AACH,sBAAIT,YAAJ,EAAkB;AACd,yBAAKS,YAAL,CAAkB,IAAlB;AACH,mBAFD,MAEO;AACH,yBAAKD,YAAL,CAAkB,IAAlB;AACH;AACJ;AACJ;AACJ;;AACD,gBAAIR,YAAJ,EAAkB;AACdK,cAAAA,KAAK,GAAGF,IAAI,CAACC,GAAL,CAASb,KAAK,GAAG,KAAKmB,cAAtB,IAAwC,CAAhD;AACH,aAFD,MAEO;AACHL,cAAAA,KAAK,GAAGd,KAAK,GAAG,KAAKe,cAAb,GAA8B,CAA9B,GAAkCf,KAA1C;AACH;;AACD,iBAAK,IAAIgB,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,EAAC,EAAhD,EAAoD;AAChD,kBAAMX,MAAU,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBU,EAAnB,CAAnB;;AACA,kBAAI,KAAKK,UAAL,IAAmB,KAAKC,UAA5B,EAAwC;AACpC,oBAAIR,KAAK,GAAG,KAAKrC,SAAL,GAAiB,CAA7B,EAAgC;AAC5BqC,kBAAAA,KAAK,GAAG,CAAR;AACH;AACJ;;AACDT,cAAAA,MAAK,CAAC,SAAD,CAAL,GAAmBS,KAAnB;AACA,mBAAKS,iBAAL,CAAuBlB,MAAvB;AACAS,cAAAA,KAAK;AACR;;AACDT,YAAAA,KAAK,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBC,IAAnB,CAAwB,UAACC,IAAD;AAAA,qBAAeA,IAAI,CAAC,SAAD,CAAJ,IAAmBR,KAAlC;AAAA,aAAxB,CAAR;AACH;;AACD,cAAI,CAACK,KAAL,EAAY;AACZ,cAAImB,OAAO,GAAGnB,KAAK,CAACoB,WAAN,GAAoBC,KAApB,EAAd;;AACA,cAAI,CAAC,KAAKxE,UAAV,EAAsB;AAClB,gBAAI,KAAKiC,QAAT,EAAmB;AACf,kBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,oBAAI,CAACa,OAAL,EAAc;AACVsB,kBAAAA,OAAO,CAACG,CAAR,GAAY,KAAKC,WAAL,CAAiBvB,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKC,UAArE;AACH,iBAFD,MAEO;AACHP,kBAAAA,OAAO,CAACG,CAAR,GAAY,KAAKK,WAAL,CAAiB3B,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKG,aAArE;AACH;AACJ,eAND,MAMO;AACH,oBAAI,CAAC/B,OAAL,EAAc;AACVsB,kBAAAA,OAAO,CAACG,CAAR,GAAY,KAAKK,WAAL,CAAiB3B,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKG,aAArE;AACH,iBAFD,MAEO;AACHT,kBAAAA,OAAO,CAACG,CAAR,GAAY,KAAKC,WAAL,CAAiBvB,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKC,UAArE;AACH;AACJ;AACJ,aAdD,MAcO;AACH,kBAAI,KAAKvC,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,oBAAI,CAACS,OAAL,EAAc;AACVsB,kBAAAA,OAAO,CAACU,CAAR,GAAY,KAAKC,WAAL,CAAiB9B,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKM,WAArE;AACH,iBAFD,MAEO;AACHZ,kBAAAA,OAAO,CAACU,CAAR,GAAY,KAAKG,WAAL,CAAiBhC,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKQ,YAArE;AACH;AACJ,eAND,MAMO;AACH,oBAAI,CAACpC,OAAL,EAAc;AACVsB,kBAAAA,OAAO,CAACU,CAAR,GAAY,KAAKG,WAAL,CAAiBhC,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKQ,YAArE;AACH,iBAFD,MAEO;AACHd,kBAAAA,OAAO,CAACU,CAAR,GAAY,KAAKC,WAAL,CAAiB9B,KAAK,CAACwB,QAAN,CAAeC,eAAhC,IAAoD,KAAKM,WAArE;AACH;AACJ;AACJ;AACJ;;AACD,cAAIG,QAAQ,uBAAG,KAAKlF,SAAR,qDAAG,iBAAgBmF,qBAAhB,CAAsChB,OAAtC,CAAf;AACA,cAAIiB,QAAQ,GAAG,KAAKlF,IAAL,CAAUmF,oBAAV,CAA+BH,QAA/B,CAAf;AACA,cAAII,QAAJ;;AACA,cAAI,CAAC,KAAKzF,UAAN,IAAoB+C,QAAxB,EAAkC;AAC9B0C,YAAAA,QAAQ,GAAG1C,QAAX;AACH,WAFD,MAEO;AACH0C,YAAAA,QAAQ,GAAG,KAAKC,eAAL,CAAqBvC,KAAK,CAACwB,QAAN,CAAeC,eAApC,EAAsD,KAAKe,cAA3D,CAAX;AACH;;AACDJ,UAAAA,QAAQ,CAACK,QAAT,CAAkB,IAAIhH,IAAJ,CAAS,CAAC,CAAV,EAAa,CAAC,CAAd,EAAiB,CAAjB,CAAlB,EAAuCiH,GAAvC,CAA2CJ,QAA3C;AACA,eAAK/D,UAAL,CAAgBoE,WAAhB,CAA4BP,QAA5B,EAAsCxD,YAAtC;AACH;AACD;;;eACU2D,e,GAAV,yBAA0BpC,IAA1B,EAA6CyC,MAA7C,EAA2D;AACvD,cAAIC,GAAG,GAAGD,MAAM,CAACvB,KAAP,EAAV;;AACA,cAAI,KAAKvC,QAAT,EAAmB;AACf,gBAAIgE,MAAM,GAAG3C,IAAI,CAACX,MAAL,GAAe,KAAKuD,YAAL,CAAkBzB,CAA9C;AACA,gBAAI0B,MAAM,GAAG7C,IAAI,CAACX,MAAL,GAAeW,IAAI,CAAC8C,OAAjC;AACAJ,YAAAA,GAAG,CAACvB,CAAJ,IAASwB,MAAM,GAAGE,MAAlB;AACH,WAJD,MAIO;AACH,gBAAIF,OAAM,GAAG3C,IAAI,CAACT,KAAL,GAAc,KAAKqD,YAAL,CAAkBlB,CAA7C;;AACA,gBAAImB,OAAM,GAAG7C,IAAI,CAACT,KAAL,GAAcS,IAAI,CAAC+C,OAAhC;;AACAL,YAAAA,GAAG,CAAChB,CAAJ,IAASiB,OAAM,GAAGE,OAAlB;AACH;;AACD,iBAAOH,GAAP;AACH;AACD;;;eACUnE,U,GAAV,sBAAuB;AACnB,cAAI,CAAC,KAAK7B,UAAV,EAAsB;AACtB,eAAK0B,UAAL,CAAgBwB,cAAhB;AACA,cAAIoD,SAAS,GAAG,IAAI1H,IAAJ,CAAS,MAAT,EAAiB,MAAjB,CAAhB;;AACA,eAAK,IAAIkF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,CAAC,EAAhD,EAAoD;AAAA;;AAChD,gBAAMX,KAAK,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBU,CAAnB,CAAd;AACA,gBAAIuB,QAAQ,uBAAG,KAAKlF,SAAR,qDAAG,iBAAgBmF,qBAAhB,CAAsCnC,KAAK,CAACoD,QAA5C,CAAf;AACA,gBAAIhB,QAAQ,GAAG,KAAKlF,IAAL,CAAUmF,oBAAV,CAA+BH,QAA/B,CAAf;AACA,gBAAImB,GAAG,GAAG;AAAE3D,cAAAA,KAAK,EAAE,KAAT;AAAgBF,cAAAA,MAAM,EAAE;AAAxB,aAAV;AAEA,gBAAI8C,QAAQ,GAAG,KAAKC,eAAL,CAAqBvC,KAAK,CAACwB,QAAN,CAAeC,eAApC,EAAsD,KAAKe,cAA3D,CAAf;AAEA,gBAAIc,WAAW,GAAGlB,QAAQ,CAACmB,QAAT,CAAkBjB,QAAlB,CAAlB;AACAe,YAAAA,GAAG,CAAC3D,KAAJ,GAAYa,IAAI,CAACC,GAAL,CAAS8C,WAAW,CAACzB,CAArB,IAA0BtB,IAAI,CAACC,GAAL,CAAS2C,SAAS,CAACtB,CAAnB,CAAtC;AACAwB,YAAAA,GAAG,CAAC7D,MAAJ,GAAae,IAAI,CAACC,GAAL,CAAS8C,WAAW,CAAChC,CAArB,IAA0Bf,IAAI,CAACC,GAAL,CAAS2C,SAAS,CAAC7B,CAAnB,CAAvC;;AACA,gBAAI,KAAKxC,QAAL,IAAiBuE,GAAG,CAAC7D,MAAzB,EAAiC;AAC7B2D,cAAAA,SAAS,GAAGG,WAAZ;AACH,aAFD,MAEO,IAAI,CAAC,KAAKxE,QAAN,IAAkBuE,GAAG,CAAC3D,KAA1B,EAAiC;AACpCyD,cAAAA,SAAS,GAAGG,WAAZ;AACH;AACJ;;AACDH,UAAAA,SAAS,CAACV,QAAV,CAAmB,IAAIhH,IAAJ,CAAS,CAAC,CAAV,EAAa,CAAC,CAAd,EAAiB,CAAjB,CAAnB;AACA,eAAK8C,UAAL,CAAgBoE,WAAhB,CAA4BQ,SAA5B,EAAuC,KAAKK,UAA5C;AACH;AACD;;;eACUC,W,GAAV,qBAAsBtD,IAAtB,EAA+C;AAC3C,cAAIpE,IAAI,GAAG,IAAIF,IAAJ,EAAX;;AACA,cAAI,KAAKiD,QAAT,EAAmB;AACf,gBAAI4E,OAAO,GAAG,KAAKC,QAAL,IAAiB,KAAKjD,cAAL,GAAsB,CAAvC,CAAd;AACA3E,YAAAA,IAAI,CAAC2D,KAAL,GAAa,CAAC,KAAKkE,aAAL,GAAqBF,OAAtB,IAAiC,KAAKhD,cAAnD;AACA3E,YAAAA,IAAI,CAACyD,MAAL,GAAcW,IAAI,CAACX,MAAnB;AACH,WAJD,MAIO;AACH,gBAAIkE,QAAO,GAAG,KAAKG,QAAL,IAAiB,KAAKnD,cAAL,GAAsB,CAAvC,CAAd;;AACA3E,YAAAA,IAAI,CAACyD,MAAL,GAAc,CAAC,KAAKsE,cAAL,GAAsBJ,QAAvB,IAAkC,KAAKhD,cAArD;AACA3E,YAAAA,IAAI,CAAC2D,KAAL,GAAaS,IAAI,CAACT,KAAlB;AACH;;AACD,iBAAO3D,IAAP;AACH;AACD;;;eACUwF,W,GAAV,qBAAsBpB,IAAtB,EAAwD;AACpD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAIX,MAAM,GAAG,KAAKuE,cAAL,CAAoB5D,IAApB,KAA6B,IAAIA,IAAI,CAAC8C,OAAtC,CAAb;AACA,iBAAO9C,IAAI,CAAC/C,IAAL,CAAUgG,QAAV,CAAmB9B,CAAnB,GAAuB9B,MAA9B;AACH;AACD;;;eACUmC,W,GAAV,qBAAsBxB,IAAtB,EAAwD;AACpD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAIX,MAAM,GAAG,KAAKuE,cAAL,CAAoB5D,IAApB,IAA4BA,IAAI,CAAC8C,OAA9C;AACA,iBAAO9C,IAAI,CAAC/C,IAAL,CAAUgG,QAAV,CAAmB9B,CAAnB,GAAuB9B,MAA9B;AACH;AACD;;;eACUwC,W,GAAV,qBAAsB7B,IAAtB,EAAwD;AACpD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAIT,KAAK,GAAG,KAAKsE,aAAL,CAAmB7D,IAAnB,KAA4B,IAAIA,IAAI,CAAC+C,OAArC,CAAZ;AACA,iBAAO/C,IAAI,CAAC/C,IAAL,CAAUgG,QAAV,CAAmBvB,CAAnB,GAAuBnC,KAA9B;AACH;AACD;;;eACUoC,W,GAAV,qBAAsB3B,IAAtB,EAAwD;AACpD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAIT,KAAK,GAAG,KAAKsE,aAAL,CAAmB7D,IAAnB,IAA2BA,IAAI,CAAC+C,OAA5C;AACA,iBAAO/C,IAAI,CAAC/C,IAAL,CAAUgG,QAAV,CAAmBvB,CAAnB,GAAuBnC,KAA9B;AACH;AACD;;;eACUuE,S,GAAV,mBAAoB9D,IAApB,EAAsD;AAClD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAI0B,CAAC,GAAG,CAAR;;AACA,cAAI,KAAK1C,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,gBAAIM,KAAK,GAAG,KAAKsE,aAAL,CAAmB7D,IAAnB,IAA2BA,IAAI,CAAC+C,OAA5C;AACArB,YAAAA,CAAC,GAAG,KAAKqC,cAAL,CAAoBrC,CAApB,GAAwBnC,KAA5B;AACH,WAHD,MAGO;AACH,gBAAIA,MAAK,GAAG,KAAKsE,aAAL,CAAmB7D,IAAnB,KAA4B,IAAIA,IAAI,CAAC+C,OAArC,CAAZ;;AACArB,YAAAA,CAAC,GAAG,KAAKqC,cAAL,CAAoBrC,CAApB,GAAwBnC,MAA5B;AACH;;AACD,iBAAOmC,CAAP;AACH;AACD;;;eACUsC,O,GAAV,iBAAkBhE,IAAlB,EAAoD;AAChD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAI0B,CAAC,GAAG,CAAR;;AACA,cAAI,KAAK1C,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,gBAAIM,KAAK,GAAG,KAAKsE,aAAL,CAAmB7D,IAAnB,KAA4B,IAAIA,IAAI,CAAC+C,OAArC,CAAZ;AACArB,YAAAA,CAAC,GAAG,CAAC,KAAKqC,cAAL,CAAoBrC,CAArB,GAAyBnC,KAAzB,GAAiC,KAAKuC,YAAtC,GAAqD,KAAKF,WAA9D;AACH,WAHD,MAGO;AACH,gBAAIrC,OAAK,GAAG,KAAKsE,aAAL,CAAmB7D,IAAnB,IAA2BA,IAAI,CAAC+C,OAA5C;;AACArB,YAAAA,CAAC,GAAG,CAAC,KAAKqC,cAAL,CAAoBrC,CAArB,GAAyBnC,OAAzB,GAAiC,KAAKqC,WAAtC,GAAoD,KAAKE,YAA7D;AACH;;AACD,iBAAOJ,CAAP;AACH;AACD;;;eACUuC,S,GAAV,mBAAoBjE,IAApB,EAAsD;AAClD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAImB,CAAC,GAAG,CAAR;;AACA,cAAI,KAAKvC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,gBAAIQ,MAAM,GAAG,KAAKuE,cAAL,CAAoB5D,IAApB,KAA6B,IAAIA,IAAI,CAAC8C,OAAtC,CAAb;AACA3B,YAAAA,CAAC,GAAG,KAAK4C,cAAL,CAAoB5C,CAApB,GAAwB9B,MAA5B;AACH,WAHD,MAGO;AACH,gBAAIA,OAAM,GAAG,KAAKuE,cAAL,CAAoB5D,IAApB,IAA4BA,IAAI,CAAC8C,OAA9C;;AACA3B,YAAAA,CAAC,GAAG,KAAK4C,cAAL,CAAoB5C,CAApB,GAAwB9B,OAA5B;AACH;;AACD,iBAAO8B,CAAP;AACH;AACD;;;eACU+C,O,GAAV,iBAAkBlE,IAAlB,EAAoD;AAChD,cAAI,CAACA,IAAL,EAAW,OAAO,CAAP;AACX,cAAImB,CAAC,GAAG,CAAR;;AACA,cAAI,KAAKvC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,gBAAIQ,MAAM,GAAG,KAAKuE,cAAL,CAAoB5D,IAApB,IAA4BA,IAAI,CAAC8C,OAA9C;AACA3B,YAAAA,CAAC,GAAG,CAAC,KAAK4C,cAAL,CAAoB5C,CAArB,GAAyB9B,MAAzB,GAAkC,KAAKoC,aAAvC,GAAuD,KAAKF,UAAhE;AACH,WAHD,MAGO;AACH,gBAAIlC,QAAM,GAAG,KAAKuE,cAAL,CAAoB5D,IAApB,KAA6B,IAAIA,IAAI,CAAC8C,OAAtC,CAAb;;AACA3B,YAAAA,CAAC,GAAG,CAAC,KAAK4C,cAAL,CAAoB5C,CAArB,GAAyB9B,QAAzB,GAAkC,KAAKkC,UAAvC,GAAoD,KAAKE,aAA7D;AACH;;AACD,iBAAON,CAAP;AACH;AACD;;;eACUgD,kB,GAAV,4BAA6BC,QAA7B,EAAoD;AAChD,cAAIC,GAAG,GAAG,KAAKjD,WAAL,CAAiBgD,QAAjB,CAAV;AACA,iBAAOC,GAAG,GAAG,KAAK9C,UAAX,GAAwB,KAAKoC,cAAL,GAAsB,GAArD;AACH;AACD;;;eACUW,qB,GAAV,+BAAgCF,QAAhC,EAAuD;AACnD,cAAIG,GAAG,GAAG,KAAK/C,WAAL,CAAiB4C,QAAjB,CAAV;AACA,iBAAOG,GAAG,GAAG,KAAK9C,aAAX,GAA2B,KAAKkC,cAAL,GAAsB,CAAC,GAAzD;AACH;AACD;;;eACUa,mB,GAAV,6BAA8BJ,QAA9B,EAAqD;AACjD,cAAIG,GAAG,GAAG,KAAK5C,WAAL,CAAiByC,QAAjB,CAAV;AACA,iBAAOG,GAAG,GAAG,KAAK3C,WAAX,GAAyB,KAAK6B,aAAL,GAAqB,CAAC,GAAtD;AACH;AACD;;;eACUgB,oB,GAAV,8BAA+BL,QAA/B,EAAsD;AAClD,cAAIC,GAAG,GAAG,KAAKxC,WAAL,CAAiBuC,QAAjB,CAAV;AACA,iBAAOC,GAAG,GAAG,KAAKvC,YAAX,GAA0B,KAAK2B,aAAL,GAAqB,GAAtD;AACH;AACD;;;eACUiB,iB,GAAV,2BAA4B1E,IAA5B,EAA+CoE,QAA/C,EAA8E;AAC1E,cAAIG,GAAG,GAAG,KAAK5C,WAAL,CAAiByC,QAAjB,CAAV;AACA,iBAAOG,GAAG,GAAG,KAAKf,QAAX,GAAsB,KAAKK,aAAL,CAAmB7D,IAAnB,KAA4B,IAAIA,IAAI,CAAC+C,OAArC,CAA7B;AACH;AACD;;;eACU4B,kB,GAAV,4BAA6B3E,IAA7B,EAAgDoE,QAAhD,EAA+E;AAC3E,cAAIC,GAAG,GAAG,KAAKxC,WAAL,CAAiBuC,QAAjB,CAAV;AACA,iBAAOC,GAAG,GAAG,KAAKb,QAAX,GAAsB,KAAKK,aAAL,CAAmB7D,IAAnB,IAA2BA,IAAI,CAAC+C,OAA7D;AACH;AACD;;;eACU6B,gB,GAAV,0BAA2B5E,IAA3B,EAA8CoE,QAA9C,EAA6E;AACzE,cAAIC,GAAG,GAAG,KAAKjD,WAAL,CAAiBgD,QAAjB,CAAV;AACA,iBAAOC,GAAG,GAAG,KAAKX,QAAX,GAAsB,KAAKE,cAAL,CAAoB5D,IAApB,KAA6B,IAAIA,IAAI,CAAC8C,OAAtC,CAA7B;AACH;AACD;;;eACU+B,mB,GAAV,6BAA8B7E,IAA9B,EAAiDoE,QAAjD,EAAgF;AAC5E,cAAIG,GAAG,GAAG,KAAK/C,WAAL,CAAiB4C,QAAjB,CAAV;AACA,iBAAOG,GAAG,GAAG,KAAKb,QAAX,GAAsB,KAAKE,cAAL,CAAoB5D,IAApB,IAA4BA,IAAI,CAAC8C,OAA9D;AACH;AACD;;;eACUgC,e,GAAV,yBAA0B9E,IAA1B,EAA6CoE,QAA7C,EAAoE1E,OAApE,EAA8F;AAAA,cAA1BA,OAA0B;AAA1BA,YAAAA,OAA0B,GAAP,KAAO;AAAA;;AAC1F,cAAIgD,GAAG,GAAG,IAAIpH,IAAJ,EAAV;;AACA,cAAI,CAAC,KAAKyJ,MAAV,EAAkB;AACdrC,YAAAA,GAAG,CAAChB,CAAJ,GAAQ,KAAKoC,SAAL,CAAe9D,IAAf,CAAR;AACA0C,YAAAA,GAAG,CAACvB,CAAJ,GAAQ,KAAK8C,SAAL,CAAejE,IAAf,CAAR;AACH,WAHD,MAGO;AACH,gBAAI,KAAKrB,QAAT,EAAmB;AACf+D,cAAAA,GAAG,GAAG,KAAKsC,2BAAL,CAAiChF,IAAjC,EAAuCoE,QAAvC,EAAiD1E,OAAjD,CAAN;AACH,aAFD,MAEO;AACHgD,cAAAA,GAAG,GAAG,KAAKuC,6BAAL,CAAmCjF,IAAnC,EAAyCoE,QAAzC,EAAmD1E,OAAnD,CAAN;AACH;AACJ;;AACDM,UAAAA,IAAI,CAAC/C,IAAL,CAAUC,WAAV,CAAsBwF,GAAtB;AACH;AACD;;;eACUsC,2B,GAAV,qCAAsChF,IAAtC,EAAyDoE,QAAzD,EAAgF1E,OAAhF,EAAkG;AAC9F,cAAIgD,GAAG,GAAG,IAAIpH,IAAJ,EAAV;AACA,cAAI4J,aAAa,GAAG,KAApB;;AACA,cAAI,KAAKlG,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvEiG,YAAAA,aAAa,GAAG,CAACxF,OAAD,GAAW,KAAK+E,oBAAL,CAA0BL,QAA1B,CAAX,GAAiD,KAAKI,mBAAL,CAAyBJ,QAAzB,CAAjE;AACH,WAFD,MAEO;AACHc,YAAAA,aAAa,GAAG,CAACxF,OAAD,GAAW,KAAK8E,mBAAL,CAAyBJ,QAAzB,CAAX,GAAgD,KAAKK,oBAAL,CAA0BL,QAA1B,CAAhE;AACH,WAP6F,CAQ9F;;;AACA,cAAI,KAAKpF,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,gBAAI,CAACS,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAG,KAAKP,kBAAL,CAAwB3E,IAAxB,EAA8BoE,QAA9B,CAAH,GAA6C,KAAKN,SAAL,CAAe9D,IAAf,CAAlE;AACH,aAFD,MAEO;AACH0C,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAG,KAAKR,iBAAL,CAAuB1E,IAAvB,EAA6BoE,QAA7B,CAAH,GAA4C,KAAKJ,OAAL,CAAahE,IAAb,CAAjE;AACH;AACJ,WAND,MAMO;AACH,gBAAI,CAACN,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAG,KAAKR,iBAAL,CAAuB1E,IAAvB,EAA6BoE,QAA7B,CAAH,GAA4C,KAAKN,SAAL,CAAe9D,IAAf,CAAjE;AACH,aAFD,MAEO;AACH0C,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAG,KAAKP,kBAAL,CAAwB3E,IAAxB,EAA8BoE,QAA9B,CAAH,GAA6C,KAAKJ,OAAL,CAAahE,IAAb,CAAlE;AACH;AACJ,WArB6F,CAsB9F;;;AACA,cAAI,KAAKpB,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,gBAAI,CAACa,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuB9B,CAA1B,GAA8B,KAAK0D,mBAAL,CAAyB7E,IAAzB,EAA+BoE,QAA/B,CAAnD;AACH,aAFD,MAEO;AACH1B,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuB9B,CAA1B,GAA8B,KAAKyD,gBAAL,CAAsB5E,IAAtB,EAA4BoE,QAA5B,CAAnD;AACH;AACJ,WAND,MAMO;AACH,gBAAI,CAAC1E,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuB9B,CAA1B,GAA8B,KAAKyD,gBAAL,CAAsB5E,IAAtB,EAA4BoE,QAA5B,CAAnD;AACH,aAFD,MAEO;AACH1B,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuB9B,CAA1B,GAA8B,KAAK0D,mBAAL,CAAyB7E,IAAzB,EAA+BoE,QAA/B,CAAnD;AACH;AACJ;;AACD,iBAAO1B,GAAP;AACH;AACD;;;eACUuC,6B,GAAV,uCAAwCjF,IAAxC,EAA2DoE,QAA3D,EAAkF1E,OAAlF,EAAoG;AAChG,cAAIgD,GAAG,GAAG,IAAIpH,IAAJ,EAAV;AACA,cAAI4J,aAAa,GAAG,KAApB;;AACA,cAAI,KAAKtG,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnEqG,YAAAA,aAAa,GAAG,CAACxF,OAAD,GAAW,KAAK4E,qBAAL,CAA2BF,QAA3B,CAAX,GAAkD,KAAKD,kBAAL,CAAwBC,QAAxB,CAAlE;AACH,WAFD,MAEO;AACHc,YAAAA,aAAa,GAAG,CAACxF,OAAD,GAAW,KAAKyE,kBAAL,CAAwBC,QAAxB,CAAX,GAA+C,KAAKE,qBAAL,CAA2BF,QAA3B,CAA/D;AACH,WAP+F,CAQhG;;;AACA,cAAI,KAAKxF,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,gBAAI,CAACa,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAG,KAAKL,mBAAL,CAAyB7E,IAAzB,EAA+BoE,QAA/B,CAAH,GAA8C,KAAKH,SAAL,CAAejE,IAAf,CAAnE;AACH,aAFD,MAEO;AACH0C,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAG,KAAKN,gBAAL,CAAsB5E,IAAtB,EAA4BoE,QAA5B,CAAH,GAA2C,KAAKF,OAAL,CAAalE,IAAb,CAAhE;AACH;AACJ,WAND,MAMO;AACH,gBAAI,CAACN,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAG,KAAKN,gBAAL,CAAsB5E,IAAtB,EAA4BoE,QAA5B,CAAH,GAA2C,KAAKH,SAAL,CAAejE,IAAf,CAAhE;AACH,aAFD,MAEO;AACH0C,cAAAA,GAAG,CAACvB,CAAJ,GAAQ+D,aAAa,GAAG,KAAKL,mBAAL,CAAyB7E,IAAzB,EAA+BoE,QAA/B,CAAH,GAA8C,KAAKF,OAAL,CAAalE,IAAb,CAAnE;AACH;AACJ,WArB+F,CAsBhG;;;AACA,cAAI,KAAKhB,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,gBAAI,CAACS,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuBvB,CAA1B,GAA8B,KAAKiD,kBAAL,CAAwB3E,IAAxB,EAA8BoE,QAA9B,CAAnD;AACH,aAFD,MAEO;AACH1B,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuBvB,CAA1B,GAA8B,KAAKgD,iBAAL,CAAuB1E,IAAvB,EAA6BoE,QAA7B,CAAnD;AACH;AACJ,WAND,MAMO;AACH,gBAAI,CAAC1E,OAAL,EAAc;AACVgD,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuBvB,CAA1B,GAA8B,KAAKgD,iBAAL,CAAuB1E,IAAvB,EAA6BoE,QAA7B,CAAnD;AACH,aAFD,MAEO;AACH1B,cAAAA,GAAG,CAAChB,CAAJ,GAAQwD,aAAa,GAAGd,QAAQ,CAACnH,IAAT,CAAcgG,QAAd,CAAuBvB,CAA1B,GAA8B,KAAKiD,kBAAL,CAAwB3E,IAAxB,EAA8BoE,QAA9B,CAAnD;AACH;AACJ;;AACD,iBAAO1B,GAAP;AACH;AACD;;;eACUvE,Y,GAAV,sBAAuBH,MAAvB,EAAuC;AACnC,cAAIA,MAAM,GAAG,CAAb,EAAgB;AACZ,iBAAK,IAAIwC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAACxC,MAArB,EAA6BwC,CAAC,EAA9B,EAAkC;AAC9B,kBAAI,KAAKK,UAAT,EAAqB;AACjB,qBAAKH,YAAL;AACH,eAFD,MAEO,IAAI,KAAKI,UAAT,EAAqB;AACxB,qBAAKJ,YAAL;AACH,eAFM,MAEA;AACH,qBAAKA,YAAL,CAAkB,IAAlB;AACH;AACJ;;AACD,gBAAIyE,UAAU,GAAG,KAAKhF,WAAL,GAAmB,CAAnB,GAAuB,KAAKA,WAA5B,GAA0C,CAA3D;;AACA,iBAAK,IAAIK,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,GAAC,EAAhD,EAAoD;AAChD,kBAAMX,KAAU,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBU,GAAnB,CAAnB;;AACA,kBAAI,KAAKK,UAAL,IAAmB,KAAKC,UAA5B,EAAwC;AACpC,oBAAIqE,UAAU,GAAG,KAAKlH,SAAL,GAAiB,CAAlC,EAAqC;AACjCkH,kBAAAA,UAAU,GAAG,CAAb;AACH;AACJ;;AACDtF,cAAAA,KAAK,CAAC,SAAD,CAAL,GAAmBsF,UAAnB;AACA,mBAAKpE,iBAAL,CAAuBlB,KAAvB;AACAsF,cAAAA,UAAU;AACb;;AACD,iBAAK/G,UAAL,CAAgBgH,eAAhB;AACH,WAvBD,MAuBO;AACH,iBAAK,IAAI5E,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,GAAC,EAAhD,EAAoD;AAChD,kBAAI,KAAK7B,QAAT,EAAmB;AACf,oBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,uBAAK4B,YAAL;AACH,iBAFD,MAEO;AACH,uBAAKC,YAAL;AACH;AACJ,eAND,MAMO;AACH,oBAAI,KAAK1B,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,uBAAKwB,YAAL;AACH,iBAFD,MAEO;AACH,uBAAKC,YAAL;AACH;AACJ;AACJ;AACJ;AACJ;AACD;;;eACgB5C,W;;;qFAAhB,kBAA4BD,KAA5B;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACI,wCAAKwH,KAAL,sEAAmB,EAAnB,EADJ,CAEI;;AAFJ,0BAGQ,KAAKpI,IAAL,CAAU6C,QAAV,CAAmBc,MAAnB,GAA4B/C,KAHpC;AAAA;AAAA;AAAA;;AAIQ,yBAAKyH,WAAL,CAAiBzH,KAAjB;AAJR,sDAKe,KALf;;AAAA;AAAA,0BAQQ,KAAK0H,eAAL,GAAuB,CAAvB,IAA4B,KAAKA,eAAL,IAAwB,KAAKtI,IAAL,CAAU6C,QAAV,CAAmBc,MAR/E;AAAA;AAAA;AAAA;;AAAA,sDASe,KATf;;AAAA;AAYI;AACIhD,oBAAAA,KAbR,GAagBC,KAAK,GAAG,KAAKZ,IAAL,CAAU6C,QAAV,CAAmBc,MAb3C,EAakD;;AAC9C,yBAAKyE,KAAL,GAAa,KAAKG,kBAAL,CAAwB5H,KAAxB,EAA+B,YAAM;AAC9C,0BAAIiC,KAAU,GAAGrE,WAAW,CAAC,MAAI,CAACiK,MAAN,CAA5B;AACA5F,sBAAAA,KAAK,CAAC,SAAD,CAAL,GAAmB,MAAI,CAAC5C,IAAL,CAAU6C,QAAV,CAAmBc,MAAtC;AACA,0BAAM/D,SAAS,GAAGgD,KAAK,CAACwB,QAAN,CAAeC,eAAjC;AACAzE,sBAAAA,SAAS,CAACC,cAAV,CAAyB,MAAI,CAACwG,WAAL,CAAiBzG,SAAjB,CAAzB;;AACA,sBAAA,MAAI,CAACiI,eAAL,CAAqBjF,KAAK,CAACwB,QAAN,CAAeC,eAApC,EAAqD,MAAI,CAACoE,MAA1D;;AACA,sBAAA,MAAI,CAACzI,IAAL,CAAU0I,QAAV,CAAmB9F,KAAnB;;AACA,sBAAA,MAAI,CAACkB,iBAAL,CAAuBlB,KAAvB;;AACAA,sBAAAA,KAAK,CAAC,QAAD,CAAL,GAAkBhD,SAAS,CAACG,WAAV,CAAsBkE,KAAtB,EAAlB;AACArB,sBAAAA,KAAK,CAAC,SAAD,CAAL,GAAmBA,KAAK,CAAC+F,QAAN,GAAiB1E,KAAjB,EAAnB;AACArB,sBAAAA,KAAK,CAACgG,EAAN,CAAS5K,IAAI,CAAC6K,SAAL,CAAeC,YAAxB,EAAsC,MAAI,CAACC,WAA3C,EAAwD,MAAxD;AACAnG,sBAAAA,KAAK,CAACgG,EAAN,CAAS5K,IAAI,CAAC6K,SAAL,CAAeG,iBAAxB,EAA2C,MAAI,CAACC,YAAhD,EAA8D,MAA9D;AACA,0BAAIC,QAAJ,EAAcC,QAAd;;AACA,0BAAI,MAAI,CAACzH,QAAT,EAAmB;AACfwH,wBAAAA,QAAQ,GAAG,MAAI,CAACnJ,WAAL,CAAiBqC,MAA5B;AACA+G,wBAAAA,QAAQ,GAAG,MAAI,CAACrJ,IAAL,CAAUsC,MAArB;AACH,uBAHD,MAGO;AACH8G,wBAAAA,QAAQ,GAAG,MAAI,CAACnJ,WAAL,CAAiBuC,KAA5B;AACA6G,wBAAAA,QAAQ,GAAG,MAAI,CAACrJ,IAAL,CAAUwC,KAArB;AACH;AACD;AACZ;AACA;AACA;AACA;AACA;;;AACY,0BAAI4G,QAAQ,IAAIC,QAAQ,GAAG,MAAI,CAACjE,QAAhC,EAA0C;AACtC,wBAAA,MAAI,CAACoD,eAAL,GAAuB,MAAI,CAACtI,IAAL,CAAU6C,QAAV,CAAmBc,MAA1C;AACA,+BAAO,KAAP;AACH;;AACD,6BAAO,IAAP;AACH,qBA/BY,CAAb;AAdJ;AAAA,2BA8CU,KAAKyF,YAAL,CAAkB,KAAKhB,KAAvB,EAA8B,EAA9B,CA9CV;;AAAA;AAAA,sDA+CW,IA/CX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,W;;;;;;;;AAiDA;;;eACUC,W,GAAV,qBAAsBzH,KAAtB,EAAqC;AACjC;AACA,cAAI+C,MAAM,GAAG,KAAK3D,IAAL,CAAU6C,QAAV,CAAmBc,MAAnB,GAA4B/C,KAAzC,CAFiC,CAGjC;;AACA,eAAK,IAAI2C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGI,MAApB,EAA4BJ,CAAC,EAA7B,EAAiC;AAC7B,gBAAIX,KAAK,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmB,KAAK7C,IAAL,CAAU6C,QAAV,CAAmBc,MAAnB,GAA4B,CAA/C,CAAZ;AACAf,YAAAA,KAAK,CAACyG,GAAN,CAAUrL,IAAI,CAAC6K,SAAL,CAAeC,YAAzB,EAAuC,KAAKC,WAA5C,EAAyD,IAAzD;AACAnG,YAAAA,KAAK,CAACyG,GAAN,CAAUrL,IAAI,CAAC6K,SAAL,CAAeG,iBAAzB,EAA4C,KAAKC,YAAjD,EAA+D,IAA/D;AACArG,YAAAA,KAAK,CAAC0G,OAAN;AACA,iBAAKtJ,IAAL,CAAUuJ,WAAV,CAAsB3G,KAAtB;AACH;AACJ,S;;eACSpC,gB,GAAV,4BAA6B;AACzB,eAAKR,IAAL,CAAU4I,EAAV,CAAazK,eAAe,CAAC6K,iBAA7B,EAAgD,KAAKQ,iBAArD,EAAwE,IAAxE;AACH,S;;eACS9I,mB,GAAV,+BAAgC;AAC5B,eAAKV,IAAL,CAAUqJ,GAAV,CAAclL,eAAe,CAAC6K,iBAA9B,EAAiD,KAAKQ,iBAAtD,EAAyE,IAAzE;AACH;AACD;;;eACUP,Y,GAAV,sBAAuB3J,IAAvB,EAAkC;AAC9B,cAAI,CAAC,KAAKmK,eAAV,EAA2B;;AAC3B,cAAInK,IAAI,IAAItB,IAAI,CAAC0L,YAAL,CAAkBC,KAA9B,EAAqC;AACjC,iBAAK,IAAIpG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,CAAC,EAAhD,EAAoD;AAChD,kBAAMX,KAAU,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBU,CAAnB,CAAnB;AACA,kBAAMqG,OAAO,GAAGhH,KAAK,CAAC,SAAD,CAArB;;AACA,kBAAI,KAAKU,cAAL,IAAuB,CAA3B,EAA8B;AAC1B,oBAAI,KAAK5B,QAAT,EAAmB;AACf,sBAAIkB,KAAK,CAACiH,KAAN,CAAYpF,CAAZ,IAAiBmF,OAAO,CAACnF,CAA7B,EAAgC;AAC5BqF,oBAAAA,OAAO,CAACC,IAAR,CAAa,cAAb;AACAnH,oBAAAA,KAAK,CAACoH,QAAN,CAAe,IAAI3L,IAAJ,CAASuL,OAAO,CAACnF,CAAjB,EAAoB7B,KAAK,CAACiH,KAAN,CAAY3F,CAAhC,CAAf;AACA;AACH;AACJ,iBAND,MAMO;AACH,sBAAItB,KAAK,CAACiH,KAAN,CAAY3F,CAAZ,IAAiB0F,OAAO,CAAC1F,CAA7B,EAAgC;AAC5B4F,oBAAAA,OAAO,CAACC,IAAR,CAAa,cAAb;AACAnH,oBAAAA,KAAK,CAACoH,QAAN,CAAe,IAAI3L,IAAJ,CAASuE,KAAK,CAACiH,KAAN,CAAY3F,CAArB,EAAwB0F,OAAO,CAAC1F,CAAhC,CAAf;AACA;AACH;AACJ;AACJ,eAdD,MAcO,IAAI,KAAKZ,cAAL,GAAsB,CAA1B,EAA6B;AAChC,oBAAI,CAACV,KAAK,CAACiH,KAAN,CAAYI,MAAZ,CAAmBL,OAAnB,CAAL,EAAkC;AAC9BE,kBAAAA,OAAO,CAACC,IAAR,CAAa,mBAAb;AACAnH,kBAAAA,KAAK,CAACoH,QAAN,CAAeJ,OAAf;AACA;AACH;AACJ;AACJ;;AACD,gBAAI,KAAKtG,cAAL,GAAsB,CAA1B,EAA6B;AAC7B,iBAAK4G,WAAL;AACH;AACJ;AACD;;;eACUnB,W,GAAV,uBAAwB;AACpB,eAAK,IAAIxF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,CAAC,EAAhD,EAAoD;AAChD,gBAAMX,KAAU,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBU,CAAnB,CAAnB;AACA,gBAAM4G,MAAM,GAAGvH,KAAK,CAAC,QAAD,CAApB;AACA,gBAAMhD,SAAS,GAAGgD,KAAK,CAACwB,QAAN,CAAeC,eAAjC;;AACA,gBAAI,KAAKf,cAAL,IAAuB,CAA3B,EAA8B;AAC1B,kBAAI,KAAK5B,QAAT,EAAmB;AACf,oBAAI,CAAA9B,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAE0C,KAAX,KAAoB6H,MAAM,CAAC7H,KAA/B,EAAsC;AAClCwH,kBAAAA,OAAO,CAACC,IAAR,CAAa,aAAb;AACAnK,kBAAAA,SAAS,CAACC,cAAV,CAAyBlB,IAAI,CAACwL,MAAM,CAAC7H,KAAR,EAAe1C,SAAS,CAACwC,MAAzB,CAA7B;AACA;AACH;AACJ,eAND,MAMO;AACH,oBAAI,CAAAxC,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAEwC,MAAX,KAAqB+H,MAAM,CAAC/H,MAAhC,EAAwC;AACpC0H,kBAAAA,OAAO,CAACC,IAAR,CAAa,aAAb;AACAnK,kBAAAA,SAAS,CAACC,cAAV,CAAyBlB,IAAI,CAACiB,SAAS,CAAC0C,KAAX,EAAkB6H,MAAM,CAAC/H,MAAzB,CAA7B;AACA;AACH;AACJ;AACJ,aAdD,MAcO,IAAI,KAAKkB,cAAL,GAAsB,CAA1B,EAA6B;AAChC,kBAAI,CAAC1D,SAAS,CAACG,WAAV,CAAsBkK,MAAtB,CAA6BE,MAA7B,CAAL,EAA2C;AACvCL,gBAAAA,OAAO,CAACC,IAAR,CAAa,mBAAb;AACAnK,gBAAAA,SAAS,CAACC,cAAV,CAAyBsK,MAAzB;AACA;AACH;AACJ;AACJ;;AACD,cAAI,KAAK7G,cAAL,GAAsB,CAA1B,EAA6B;AAC7B,eAAK4G,WAAL;AACH;AACD;;;eACUA,W,GAAV,qBAAsB7G,KAAtB,EAA8C;AAAA,cAAxBA,KAAwB;AAAxBA,YAAAA,KAAwB,GAAP,KAAO;AAAA;;AAC1C,cAAI+G,QAAa,GAAG,KAAKtC,MAAzB;;AACA,cAAI,KAAKpG,QAAL,IAAiB,KAAKS,eAAL,IAAwB,KAAKrC,IAAL,CAAUsC,MAAnD,IAA6D,CAAC,KAAKV,QAAN,IAAkB,KAAKW,cAAL,IAAuB,KAAKvC,IAAL,CAAUwC,KAApH,EAA2H;AAAA;;AACvH,gBAAImC,CAAC,GAAG,KAAKoC,SAAL,CAAe,KAAKiB,MAApB,CAAR;AACA,gBAAI5D,CAAC,GAAG,KAAK8C,SAAL,CAAe,KAAKc,MAApB,CAAR;AACA,iCAAKA,MAAL,8DAAa9H,IAAb,CAAkBC,WAAlB,CAA8B,IAAI5B,IAAJ,CAASoG,CAAT,EAAYP,CAAZ,CAA9B;AACH;;AACD,cAAIb,KAAJ,EAAW;AACP,gBAAI,KAAK3B,QAAT,EAAmB;AAAA;;AACf,kBAAI+C,GAAC,GAAG,KAAKoC,SAAL,CAAe,KAAKiB,MAApB,CAAR;;AACA,oCAAKA,MAAL,gEAAa9H,IAAb,CAAkBC,WAAlB,CAA8B,IAAI5B,IAAJ,CAASoG,GAAT,EAAY,KAAKqD,MAAL,CAAY9H,IAAZ,CAAiBgG,QAAjB,CAA0B9B,CAAtC,CAA9B;AACH,aAHD,MAGO;AAAA;;AACH,kBAAIA,EAAC,GAAG,KAAK8C,SAAL,CAAe,KAAKc,MAApB,CAAR;;AACA,oCAAKA,MAAL,gEAAa9H,IAAb,CAAkBC,WAAlB,CAA8B,IAAI5B,IAAJ,CAAS,KAAKyJ,MAAL,CAAY9H,IAAZ,CAAiBgG,QAAjB,CAA0BvB,CAAnC,EAAsCP,EAAtC,CAA9B;AACH;AACJ;;AACD,eAAK,IAAIX,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,CAAC,EAAhD,EAAoD;AAChD,gBAAMX,KAAK,GAAG,KAAK5C,IAAL,CAAU6C,QAAV,CAAmBU,CAAnB,CAAd;AACA,gBAAM3D,SAAS,GAAGgD,KAAK,CAACwB,QAAN,CAAeC,eAAjC;AACA,gBAAI8C,QAAQ,GAAG,CAACiD,QAAD,GAAY,KAAKtC,MAAjB,GAA0BsC,QAAzC;AACA,iBAAKvC,eAAL,CAAqBjI,SAArB,EAAgCuH,QAAhC;AACAiD,YAAAA,QAAQ,GAAGxK,SAAX;AACH;;AACD,eAAKuB,UAAL,CAAgBgH,eAAhB;AACH,S;;eACSkC,iB,GAAV,2BAA4BC,KAA5B,EAA2C;AACvC,iBAAO,KAAKb,eAAL,GAAuBtG,IAAI,CAACC,GAAL,CAASkH,KAAT,CAAvB,GAAyC,CAAhD;AACH,S;;eACS1D,a,GAAV,uBAAwB2D,KAAxB,EAA2D;AACvD,cAAI,CAACA,KAAL,EAAY,OAAO,CAAP;AACZ,iBAAOA,KAAK,CAACjI,KAAN,GAAc,KAAK+H,iBAAL,CAAuBE,KAAK,CAACvK,IAAN,CAAW6J,KAAX,CAAiBpF,CAAxC,CAArB;AACH,S;;eACSkC,c,GAAV,wBAAyB4D,KAAzB,EAA4D;AACxD,cAAI,CAACA,KAAL,EAAY,OAAO,CAAP;AACZ,iBAAOA,KAAK,CAACnI,MAAN,GAAe,KAAKiI,iBAAL,CAAuBE,KAAK,CAACvK,IAAN,CAAW6J,KAAX,CAAiB3F,CAAxC,CAAtB;AACH,S;;eACSsF,iB,GAAV,6BAA8B;AAC1B,cAAI,KAAK9H,QAAT,EAAmB;AACf,gBAAI,KAAKP,UAAL,CAAgBqJ,YAAhB,CAA6BtG,CAA7B,GAAiC,KAAK/C,UAAL,CAAgBsJ,QAAhB,CAAyBvG,CAA9D,EAAiE;AAC7D,mBAAKwG,eAAL,GAAuBtL,eAAe,CAACuL,MAAvC;AACH,aAFD,MAEO,IAAI,KAAKxJ,UAAL,CAAgBqJ,YAAhB,CAA6BtG,CAA7B,GAAiC,KAAK/C,UAAL,CAAgBsJ,QAAhB,CAAyBvG,CAA9D,EAAiE;AACpE,mBAAKwG,eAAL,GAAuBtL,eAAe,CAACwL,MAAvC;AACH,aAFM,MAEA;AACH,mBAAKF,eAAL,GAAuBtL,eAAe,CAACM,IAAvC;AACH;AACJ,WARD,MAQO;AACH,gBAAI,KAAKyB,UAAL,CAAgBqJ,YAAhB,CAA6B/F,CAA7B,GAAiC,KAAKtD,UAAL,CAAgBsJ,QAAhB,CAAyBhG,CAA9D,EAAiE;AAC7D,mBAAKiG,eAAL,GAAuBtL,eAAe,CAACuL,MAAvC;AACH,aAFD,MAEO,IAAI,KAAKxJ,UAAL,CAAgBqJ,YAAhB,CAA6B/F,CAA7B,GAAiC,KAAKtD,UAAL,CAAgBsJ,QAAhB,CAAyBhG,CAA9D,EAAiE;AACpE,mBAAKiG,eAAL,GAAuBtL,eAAe,CAACwL,MAAvC;AACH,aAFM,MAEA;AACH,mBAAKF,eAAL,GAAuBtL,eAAe,CAACM,IAAvC;AACH;AACJ;;AAED,cAAI,KAAKgC,QAAT,EAAmB;AACf,iBAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,CAAC,EAAhD,EAAoD;AAChD,kBAAIsH,YAAY,GAAG1H,IAAI,CAACC,GAAL,CAAS,KAAK0H,OAAL,CAAa5G,CAAb,GAAiB,KAAKlE,IAAL,CAAUgG,QAAV,CAAmB9B,CAA7C,IAAkDlF,OAArE;AACA,kBAAI,CAAC6L,YAAL,EAAmB;;AACnB,kBAAI,KAAKC,OAAL,CAAa5G,CAAb,GAAiB,KAAKlE,IAAL,CAAUgG,QAAV,CAAmB9B,CAAxC,EAA2C;AACvC,qBAAKV,YAAL;AACH,eAFD,MAEO,IAAI,KAAKsH,OAAL,CAAa5G,CAAb,GAAiB,KAAKlE,IAAL,CAAUgG,QAAV,CAAmB9B,CAAxC,EAA2C;AAC9C,qBAAKT,YAAL;AACH;AACJ;AACJ,WAVD,MAUO;AACH,iBAAK,IAAIF,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAG,KAAKvD,IAAL,CAAU6C,QAAV,CAAmBc,MAAvC,EAA+CJ,GAAC,EAAhD,EAAoD;AAChD,kBAAIsH,aAAY,GAAG1H,IAAI,CAACC,GAAL,CAAS,KAAK0H,OAAL,CAAarG,CAAb,GAAiB,KAAKzE,IAAL,CAAUgG,QAAV,CAAmBvB,CAA7C,IAAkDzF,OAArE;;AACA,kBAAI,CAAC6L,aAAL,EAAmB;;AACnB,kBAAI,KAAKC,OAAL,CAAarG,CAAb,GAAiB,KAAKzE,IAAL,CAAUgG,QAAV,CAAmBvB,CAAxC,EAA2C;AACvC,qBAAKjB,YAAL;AACH,eAFD,MAEO,IAAI,KAAKsH,OAAL,CAAarG,CAAb,GAAiB,KAAKzE,IAAL,CAAUgG,QAAV,CAAmBvB,CAAxC,EAA2C;AAC9C,qBAAKhB,YAAL;AACH;AACJ;AACJ;;AACD,eAAKqH,OAAL,GAAe,KAAK9K,IAAL,CAAUgG,QAAV,CAAmB/B,KAAnB,EAAf;AACH;AACD;;;eACUT,Y,GAAV,sBAAuBuH,KAAvB,EAA+C;AAAA,cAAxBA,KAAwB;AAAxBA,YAAAA,KAAwB,GAAP,KAAO;AAAA;;AAC3C,cAAI,KAAKrJ,QAAT,EAAmB;AACf,gBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AAAA;;AACnE,kBAAImJ,KAAK,IAAI,KAAKC,cAAL,GAAsB,KAAK1G,UAA3B,GAAwC,KAAKzC,kBAAL,qBAA0B,KAAKiG,MAA/B,kDAA0B,cAAa1F,MAAvC,CAArD,EAAqG;AACjG,qBAAK6I,mBAAL;AACH;AACJ,aAJD,MAIO;AAAA;;AACH,kBAAIF,KAAK,IAAI,KAAKG,cAAL,GAAsB,KAAK5G,UAA3B,GAAwC,KAAKzC,kBAAL,qBAA0B,KAAKiG,MAA/B,kDAA0B,cAAa1F,MAAvC,CAArD,EAAqG;AACjG,qBAAK+I,mBAAL;AACH;AACJ;AACJ,WAVD,MAUO;AACH,gBAAI,KAAKpJ,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AAAA;;AACvE,kBAAI+I,KAAK,IAAI,KAAKC,cAAL,GAAsB,KAAKrG,WAA3B,GAAyC,KAAK9C,kBAAL,qBAA0B,KAAKiG,MAA/B,kDAA0B,cAAaxF,KAAvC,CAAtD,EAAqG;AACjG,qBAAK2I,mBAAL;AACH;AACJ,aAJD,MAIO;AAAA;;AACH,kBAAIF,KAAK,IAAI,KAAKG,cAAL,GAAsB,KAAKvG,WAA3B,GAAyC,KAAK9C,kBAAL,qBAA0B,KAAKiG,MAA/B,kDAA0B,cAAaxF,KAAvC,CAAtD,EAAqG;AACjG,qBAAK6I,mBAAL;AACH;AACJ;AACJ;AACJ;AACD;;;eACU1H,Y,GAAV,sBAAuBsH,KAAvB,EAA+C;AAAA,cAAxBA,KAAwB;AAAxBA,YAAAA,KAAwB,GAAP,KAAO;AAAA;;AAC3C,cAAI,KAAKrJ,QAAT,EAAmB;AACf,gBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AAAA;;AACnE,kBAAImJ,KAAK,IAAI,KAAKG,cAAL,GAAsB,KAAK1G,aAA3B,GAA2C,KAAK1C,kBAAL,oBAA0B,KAAK2G,MAA/B,iDAA0B,aAAarG,MAAvC,CAAxD,EAAwG;AACpG,qBAAK+I,mBAAL;AACH;AACJ,aAJD,MAIO;AAAA;;AACH,kBAAIJ,KAAK,IAAI,KAAKC,cAAL,GAAsB,KAAKxG,aAA3B,GAA2C,KAAK1C,kBAAL,qBAA0B,KAAK2G,MAA/B,kDAA0B,cAAarG,MAAvC,CAAxD,EAAwG;AACpG,qBAAK6I,mBAAL;AACH;AACJ;AACJ,WAVD,MAUO;AACH,gBAAI,KAAKlJ,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AAAA;;AACvE,kBAAI+I,KAAK,IAAI,KAAKG,cAAL,GAAsB,KAAKrG,YAA3B,GAA0C,KAAK/C,kBAAL,qBAA0B,KAAK2G,MAA/B,kDAA0B,cAAanG,KAAvC,CAAvD,EAAsG;AAClG,qBAAK6I,mBAAL;AACH;AACJ,aAJD,MAIO;AAAA;;AACH,kBAAIJ,KAAK,IAAI,KAAKC,cAAL,GAAsB,KAAKnG,YAA3B,GAA0C,KAAK/C,kBAAL,qBAA0B,KAAK2G,MAA/B,kDAA0B,cAAanG,KAAvC,CAAvD,EAAsG;AAClG,qBAAK2I,mBAAL;AACH;AACJ;AACJ;AACJ,S;;eACSA,mB,GAAV,+BAAgC;AAAA;;AAC5B,cAAIjL,IAAS,oBAAG,KAAK8H,MAAR,kDAAG,cAAa9H,IAA7B;;AACA,cAAI,KAAK6D,UAAT,EAAqB;AACjB,gBAAI,KAAKZ,WAAL,IAAoB,KAAKjC,SAAL,GAAiB,CAAzC,EAA4C;AACxChB,cAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkB,CAAlB;AACH,aAFD,MAEO;AACHA,cAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkB,KAAKiD,WAAL,GAAmB,CAArC;AACH;AACJ,WAND,MAMO;AACH,gBAAI,CAAC,KAAKwF,MAAN,IAAgB,KAAKxF,WAAL,IAAoB,KAAKjC,SAAL,GAAiB,CAAzD,EAA4D;AAC5DhB,YAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkB,KAAKiD,WAAL,GAAmB,CAArC;AACH;;AACD,eAAKa,iBAAL,CAAuB9D,IAAvB;AACA,eAAK6H,eAAL,CAAqB,KAAKC,MAA1B,EAAmC,KAAKW,MAAxC;AACA,gCAAKX,MAAL,gEAAa9H,IAAb,CAAkBoL,eAAlB,CAAkC,KAAKpL,IAAL,CAAU6C,QAAV,CAAmBc,MAArD;AACH,S;;eACSwH,mB,GAAV,+BAAgC;AAAA;;AAC5B,cAAInL,IAAS,oBAAG,KAAKyI,MAAR,kDAAG,cAAazI,IAA7B;;AACA,cAAI,KAAK4D,UAAT,EAAqB;AACjB,gBAAI,KAAKV,WAAL,IAAoB,CAAxB,EAA2B;AACvBlD,cAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkB,KAAKgB,SAAL,GAAiB,CAAnC;AACH,aAFD,MAEO;AACHhB,cAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkB,KAAKkD,WAAL,GAAmB,CAArC;AACH;AACJ,WAND,MAMO;AACH,gBAAI,CAAC,KAAK4E,MAAN,IAAgB,KAAK5E,WAAL,IAAoB,CAAxC,EAA2C;AAC3ClD,YAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkB,KAAKkD,WAAL,GAAmB,CAArC;AACH;;AACD,eAAKY,iBAAL,CAAuB9D,IAAvB;AACA,eAAK6H,eAAL,CAAqB,KAAKY,MAA1B,EAAmC,KAAKX,MAAxC,EAAiD,IAAjD;AACA,gCAAKW,MAAL,gEAAazI,IAAb,CAAkBoL,eAAlB,CAAkC,CAAlC,EAd4B,CAe5B;;AACA,cAAI,CAAC,KAAKxH,UAAN,IAAoB,KAAKV,WAAL,IAAoB,CAA5C,EAA+C;AAC3C;AACA,gBAAImI,WAAW,GAAG,KAAK9D,mBAAL,CAAyB,KAAKO,MAA9B,CAAlB;;AACA,gBAAIuD,WAAJ,EAAiB;AACb,mBAAKnB,WAAL,CAAiB,IAAjB;AACH;AACJ;AACJ;AACD;;;eACUpG,iB,GAAV,2BAA4BwH,MAA5B,EAA0C;AACtChN,UAAAA,YAAY,CAACiN,UAAb,CAAwB,KAAKC,iBAA7B,EAAgDF,MAAhD,EAAyDA,MAAD,CAAgB,SAAhB,CAAxD;AACH;AACD;;;eACY/C,kB;;gCAAZ,4BAA+B5E,MAA/B,EAA+C8H,QAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,8CAAsEC,MAAtE;AAAsEA,oBAAAA,MAAtE;AAAA;;AACanI,kBAAAA,CADb,GACiB,CADjB;;AAAA;AAAA,wBACoBA,CAAC,GAAGI,MADxB;AAAA;AAAA;AAAA;;AAEYgI,kBAAAA,MAFZ,GAEqBF,QAAQ,MAAR,UAASlI,CAAT,SAAemI,MAAf,EAFrB;;AAAA,uBAGYC,MAHZ;AAAA;AAAA;AAAA;;AAAA;AAIY;;AAJZ;AAAA;AAAA;;AAAA;AAAA;;AAAA;AACgCpI,kBAAAA,CAAC,EADjC;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,S;AAUA;;;eACU6F,Y,GAAV,sBAAuBwC,SAAvB,EAA6CC,QAA7C,EAA+D;AAC3D,iBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,gBAAIC,GAAG,GAAGL,SAAV;;AACA,gBAAIM,OAAO,GAAG,SAAVA,OAAU,GAAM;AAChB,kBAAIC,SAAS,GAAG,IAAIC,IAAJ,GAAWC,OAAX,EAAhB;;AACA,mBAAK,IAAIC,IAAI,GAAGL,GAAG,CAACM,IAAJ,EAAhB,GAA8BD,IAAI,GAAGL,GAAG,CAACM,IAAJ,EAArC,EAAiD;AAC7C,oBAAID,IAAI,IAAI,IAAR,IAAgBA,IAAI,CAACE,IAAzB,EAA+B;AAC3BT,kBAAAA,OAAO,CAAC,IAAD,CAAP;AACA;AACH;;AACD,oBAAI,IAAIK,IAAJ,GAAWC,OAAX,KAAuBF,SAAvB,GAAmCN,QAAvC,EAAiD;AAC7CY,kBAAAA,UAAU,CAAC;AAAA,2BAAMP,OAAO,EAAb;AAAA,mBAAD,EAAkB9N,QAAQ,CAACsO,YAAT,EAAlB,CAAV;AACA;AACH;AACJ;AACJ,aAZD;;AAaAR,YAAAA,OAAO;AACV,WAhBM,CAAP;AAiBH,S;;;;;AAvpCD;AACA,yBAAwB;AAAE,mBAAO,KAAKS,UAAL,IAAmB1N,IAAI,CAAC2N,QAA/B;AAAyC;AACnE;;;;eACA,eAA0B;AAAE,mBAAO,KAAKD,UAAL,IAAmB1N,IAAI,CAAC4N,UAA/B;AAA2C;;;eACvE,eAAoC;AAAE,mBAAO,KAAK7M,IAAL,CAAUoE,QAAV,CAAmBC,eAA1B;AAA2C;AACjF;;;;eACA,eAAoB;AAChB,mBAAO,KAAKvE,IAAL,CAAUwC,KAAV,GAAkB,KAAKqC,WAAvB,GAAqC,KAAKE,YAAjD;AACH;AACD;;;;eACA,eAAqB;AACjB,mBAAO,KAAK/E,IAAL,CAAUsC,MAAV,GAAmB,KAAKkC,UAAxB,GAAqC,KAAKE,aAAjD;AACH;AACD;;;;eACA,eAAiC;AAC7B,gBAAI,KAAKxE,IAAL,CAAU6C,QAAV,CAAmBc,MAAnB,IAA6B,CAAjC,EAAoC,OAAO,IAAP;AACpC,mBAAO,KAAK3D,IAAL,CAAU6C,QAAV,CAAmB,CAAnB,EAAsBuB,QAAtB,CAA+BC,eAAtC;AACH;AACD;;;;eACA,eAAiC;AAC7B,gBAAI,KAAKrE,IAAL,CAAU6C,QAAV,CAAmBc,MAAnB,IAA6B,CAAjC,EAAoC,OAAO,IAAP;AACpC,mBAAO,KAAK3D,IAAL,CAAU6C,QAAV,CAAmB,KAAK7C,IAAL,CAAU6C,QAAV,CAAmBc,MAAnB,GAA4B,CAA/C,EAAkDS,QAAlD,CAA2DC,eAAlE;AACH;AACD;;;;eACA,eAA0B;AACtB,gBAAI,CAAC,KAAKyD,MAAV,EAAkB,OAAO,CAAC,CAAR;AAClB,gBAAI9H,IAAS,GAAG,KAAK8H,MAAL,CAAY9H,IAA5B;AACA,mBAAOA,IAAI,CAAC,SAAD,CAAX;AACH;AACD;;;;eACA,eAA0B;AACtB,gBAAI,CAAC,KAAKyI,MAAV,EAAkB,OAAO,CAAC,CAAR;AAClB,gBAAIzI,IAAS,GAAG,KAAKyI,MAAL,CAAYzI,IAA5B;AACA,mBAAOA,IAAI,CAAC,SAAD,CAAX;AACH;AACD;;;;eACA,eAA2B;AACvB,gBAAIyF,GAAG,GAAG,IAAIpH,IAAJ,EAAV;;AACA,gBAAI,KAAK0D,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvEyD,cAAAA,GAAG,CAAChB,CAAJ,GAAQ,KAAK3E,IAAL,CAAUwC,KAAV,GAAkB,CAAC,GAAnB,GAAyB,KAAKqC,WAAtC;AACH,aAFD,MAEO;AACHc,cAAAA,GAAG,CAAChB,CAAJ,GAAQ,KAAK3E,IAAL,CAAUwC,KAAV,GAAkB,GAAlB,GAAwB,KAAKuC,YAArC;AACH;;AACD,gBAAI,KAAKlD,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE6D,cAAAA,GAAG,CAACvB,CAAJ,GAAQ,KAAKpE,IAAL,CAAUsC,MAAV,GAAmB,GAAnB,GAAyB,KAAKkC,UAAtC;AACH,aAFD,MAEO;AACHmB,cAAAA,GAAG,CAACvB,CAAJ,GAAQ,KAAKpE,IAAL,CAAUsC,MAAV,GAAmB,CAAC,GAApB,GAA0B,KAAKoC,aAAvC;AACH;;AACD,mBAAOiB,GAAP;AACH;AACD;;;;eACA,eAAiC;AAC7B,gBAAI1E,MAAM,GAAG,CAAb;;AACA,gBAAI,KAAKW,QAAT,EAAmB;AACfX,cAAAA,MAAM,GAAG,KAAKjB,IAAL,CAAUsC,MAAV,GAAmB,GAA5B;AACH,aAFD,MAEO;AACHrB,cAAAA,MAAM,GAAG,KAAKjB,IAAL,CAAUwC,KAAV,GAAkB,CAAC,GAA5B;AACH;;AACD,mBAAOvB,MAAP;AACH;AACD;;;;eACA,eAAiC;AAC7B,gBAAIA,MAAM,GAAG,CAAb;;AACA,gBAAI,KAAKW,QAAT,EAAmB;AACfX,cAAAA,MAAM,GAAG,KAAKjB,IAAL,CAAUsC,MAAV,GAAmB,CAAC,GAA7B;AACH,aAFD,MAEO;AACHrB,cAAAA,MAAM,GAAG,KAAKjB,IAAL,CAAUwC,KAAV,GAAkB,GAA3B;AACH;;AACD,mBAAOvB,MAAP;AACH;AACD;;;;eACA,eAA6B;AACzB,gBAAI,CAAC,KAAK+G,MAAV,EAAkB,OAAO,CAAP;;AAClB,gBAAI,KAAKpG,QAAT,EAAmB;AACf,kBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,uBAAO,KAAK5B,IAAL,CAAUgG,QAAV,CAAmB9B,CAAnB,GAAuB,KAAKC,WAAL,CAAiB,KAAK2D,MAAtB,CAAvB,GAAuD,KAAKxD,UAAnE;AACH,eAFD,MAEO;AACH,uBAAO,KAAKtE,IAAL,CAAUgG,QAAV,CAAmB9B,CAAnB,GAAuB,KAAKK,WAAL,CAAiB,KAAKuD,MAAtB,CAAvB,GAAuD,KAAKtD,aAAnE;AACH;AACJ,aAND,MAMO;AACH,kBAAI,KAAKzC,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,uBAAO,KAAKhC,IAAL,CAAUgG,QAAV,CAAmBvB,CAAnB,GAAuB,KAAKC,WAAL,CAAiB,KAAKoD,MAAtB,CAAvB,GAAuD,KAAKnD,WAAnE;AACH,eAFD,MAEO;AACH,uBAAO,KAAK3E,IAAL,CAAUgG,QAAV,CAAmBvB,CAAnB,GAAuB,KAAKG,WAAL,CAAiB,KAAKkD,MAAtB,CAAvB,GAAuD,KAAKjD,YAAnE;AACH;AACJ;AACJ;AACD;;;;eACA,eAA6B;AACzB,gBAAI,CAAC,KAAK4D,MAAV,EAAkB,OAAO,CAAP;;AAClB,gBAAI,KAAK/G,QAAT,EAAmB;AACf,kBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,uBAAO,KAAK5B,IAAL,CAAUgG,QAAV,CAAmB9B,CAAnB,GAAuB,KAAKK,WAAL,CAAiB,KAAKkE,MAAtB,CAAvB,GAAuD,KAAKjE,aAAnE;AACH,eAFD,MAEO;AACH,uBAAO,KAAKxE,IAAL,CAAUgG,QAAV,CAAmB9B,CAAnB,GAAuB,KAAKC,WAAL,CAAiB,KAAKsE,MAAtB,CAAvB,GAAuD,KAAKnE,UAAnE;AACH;AACJ,aAND,MAMO;AACH,kBAAI,KAAKvC,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,uBAAO,KAAKhC,IAAL,CAAUgG,QAAV,CAAmBvB,CAAnB,GAAuB,KAAKG,WAAL,CAAiB,KAAK6D,MAAtB,CAAvB,GAAuD,KAAK5D,YAAnE;AACH,eAFD,MAEO;AACH,uBAAO,KAAK7E,IAAL,CAAUgG,QAAV,CAAmBvB,CAAnB,GAAuB,KAAKC,WAAL,CAAiB,KAAK+D,MAAtB,CAAvB,GAAuD,KAAK9D,WAAnE;AACH;AACJ;AACJ;AACD;;;;eACA,eAA2B;AACvB,gBAAImI,GAAG,GAAG,KAAKpL,QAAL,GAAgB,GAAhB,GAAsB,GAAhC;;AACA,gBAAI,KAAKqL,UAAT,EAAqB;AACjB,kBAAI,KAAKrL,QAAT,EAAmB;AACf,oBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,yBAAO,KAAKoJ,cAAL,IAAuB,KAAKnJ,kBAAL,GAA2B,KAAKkL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH,iBAFD,MAEO;AACH,yBAAO,KAAK5B,cAAL,IAAuB,KAAKrJ,kBAAL,GAA2B,KAAKkL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH;AACJ,eAND,MAMO;AACH,oBAAI,KAAK/K,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,yBAAO,KAAKgJ,cAAL,IAAuB,KAAKnJ,kBAAL,GAA2B,KAAKkL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH,iBAFD,MAEO;AACH,yBAAO,KAAK5B,cAAL,IAAuB,KAAKrJ,kBAAL,GAA2B,KAAKkL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH;AACJ;AACJ,aAdD,MAcO;AACH,kBAAI,KAAK/K,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,uBAAO,KAAKgJ,cAAL,IAAuB,KAAKnJ,kBAAL,GAA2B,KAAK/B,IAAL,CAAUE,IAAV,CAAegG,QAAhB,CAAiC8G,GAAjC,CAAjD,CAAP;AACH,eAFD,MAEO;AACH,uBAAO,KAAK5B,cAAL,IAAuB,KAAKrJ,kBAAL,GAA2B,KAAK/B,IAAL,CAAUE,IAAV,CAAegG,QAAhB,CAAiC8G,GAAjC,CAAjD,CAAP;AACH;AACJ;AACJ;AACD;;;;eACA,eAA2B;AACvB,gBAAIA,GAAG,GAAG,KAAKpL,QAAL,GAAgB,GAAhB,GAAsB,GAAhC;;AACA,gBAAI,KAAKqL,UAAT,EAAqB;AACjB,kBAAI,KAAKrL,QAAT,EAAmB;AACf,oBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,yBAAO,KAAKsJ,cAAL,IAAuB,KAAKpJ,kBAAL,GAA2B,KAAKiL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH,iBAFD,MAEO;AACH,yBAAO,KAAK9B,cAAL,IAAuB,KAAKlJ,kBAAL,GAA2B,KAAKiL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH;AACJ,eAND,MAMO;AACH,oBAAI,KAAK/K,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,yBAAO,KAAKkJ,cAAL,IAAuB,KAAKpJ,kBAAL,GAA2B,KAAKiL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH,iBAFD,MAEO;AACH,yBAAO,KAAK9B,cAAL,IAAuB,KAAKlJ,kBAAL,GAA2B,KAAKiL,UAAL,CAAgB/G,QAAjB,CAAkC8G,GAAlC,CAAjD,CAAP;AACH;AACJ;AACJ,aAdD,MAcO;AACH,kBAAI,KAAKpL,QAAT,EAAmB;AACf,oBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,yBAAO,KAAKsJ,cAAL,IAAuB,KAAKpJ,kBAAL,GAA2B,KAAKhC,IAAL,CAAUE,IAAV,CAAegG,QAAhB,CAAiC8G,GAAjC,CAAjD,CAAP;AACH,iBAFD,MAEO;AACH,yBAAO,KAAK9B,cAAL,IAAuB,KAAKlJ,kBAAL,GAA2B,KAAKhC,IAAL,CAAUE,IAAV,CAAegG,QAAhB,CAAiC8G,GAAjC,CAAjD,CAAP;AACH;AACJ,eAND,MAMO;AACH,oBAAI,KAAK/K,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,yBAAO,KAAKkJ,cAAL,IAAuB,KAAKpJ,kBAAL,GAA2B,KAAKhC,IAAL,CAAUE,IAAV,CAAegG,QAAhB,CAAiC8G,GAAjC,CAAjD,CAAP;AACH,iBAFD,MAEO;AACH,yBAAO,KAAK9B,cAAL,IAAuB,KAAKlJ,kBAAL,GAA2B,KAAKhC,IAAL,CAAUE,IAAV,CAAegG,QAAhB,CAAiC8G,GAAjC,CAAjD,CAAP;AACH;AACJ;AACJ;AACJ;AACD;;;;eACA,eAA+B;AAC3B,gBAAI,KAAKpL,QAAT,EAAmB,OAAO,CAAP;;AACnB,gBAAI,KAAKjC,UAAT,EAAqB;AACjB,kBAAI,KAAKiL,eAAL,IAAwBtL,eAAe,CAACwL,MAA5C,EAAoD;AAChD,uBAAO,KAAKoC,oBAAZ;AACH;;AACD,qBAAO,CAAP;AACH;;AACD,gBAAI,KAAKpJ,UAAT,EAAqB;AACjB,kBAAI,KAAKkE,MAAT,EAAiB,OAAO,CAAP;AACjB,qBAAO,KAAKjG,kBAAL,GAA0B,KAAK7B,IAAL,CAAUgG,QAAV,CAAmBvB,CAApD;AACH;;AAED,gBAAI,CAAC,KAAKqD,MAAN,IAAgB,KAAKzF,cAAL,IAAuB,KAAKvC,IAAL,CAAUwC,KAArD,EAA4D;AACxD,qBAAO,KAAKT,kBAAL,GAA0B,KAAK7B,IAAL,CAAUgG,QAAV,CAAmBvB,CAApD;AACH;;AACD,gBAAI,KAAK1C,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,kBAAI,KAAKkB,WAAL,IAAoB,CAAxB,EAA2B;AACvB,uBAAO,KAAK8H,cAAZ;AACH;AACJ,aAJD,MAIO;AACH,kBAAI,KAAK/H,WAAL,IAAoB,KAAKjC,SAAL,GAAiB,CAAzC,EAA4C;AACxC,uBAAO,MAAM,KAAKkK,cAAlB;AACH;AACJ;;AACD,mBAAO,CAAP;AACH;AACD;;;;eACA,eAA8B;AAC1B,gBAAI,CAAC,KAAKxJ,QAAV,EAAoB,OAAO,CAAP;;AACpB,gBAAI,KAAKjC,UAAT,EAAqB;AACjB,kBAAI,KAAKiL,eAAL,IAAwBtL,eAAe,CAACwL,MAA5C,EAAoD;AAChD,uBAAO,KAAKoC,oBAAZ;AACH;;AACD,qBAAO,CAAP;AACH;;AACD,gBAAI,KAAKpJ,UAAT,EAAqB;AACjB,kBAAI,KAAKkE,MAAT,EAAiB,OAAO,CAAP;AACjB,qBAAO,KAAKjG,kBAAL,GAA0B,KAAK7B,IAAL,CAAUgG,QAAV,CAAmB9B,CAApD;AACH;;AACD,gBAAI,CAAC,KAAK4D,MAAN,IAAgB,KAAK3F,eAAL,IAAwB,KAAKrC,IAAL,CAAUsC,MAAtD,EAA8D;AAC1D,qBAAO,KAAKP,kBAAL,GAA0B,KAAK7B,IAAL,CAAUgG,QAAV,CAAmB9B,CAApD;AACH;;AACD,gBAAI,KAAKvC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,kBAAI,KAAKsB,WAAL,IAAoB,CAAxB,EAA2B;AACvB,uBAAO,KAAK8H,cAAZ;AACH;AACJ,aAJD,MAIO;AACH,kBAAI,KAAK/H,WAAL,IAAoB,KAAKjC,SAAL,GAAiB,CAAzC,EAA4C;AACxC,uBAAO,KAAKkK,cAAZ;AACH;AACJ;;AACD,mBAAO,CAAP;AACH;AACD;;;;eACA,eAAgC;AAC5B,gBAAI,KAAKxJ,QAAT,EAAmB,OAAO,CAAP;;AACnB,gBAAI,KAAKjC,UAAT,EAAqB;AACjB,kBAAI,KAAKiL,eAAL,IAAwBtL,eAAe,CAACuL,MAA5C,EAAoD;AAChD,uBAAO,KAAKsC,oBAAZ;AACH;;AACD,qBAAO,CAAP;AACH;;AACD,gBAAI,KAAKpJ,UAAT,EAAqB;AACjB,kBAAI,KAAK4E,MAAT,EAAiB,OAAO,CAAP;AACjB,qBAAO,KAAK3G,kBAAL,GAA0B,KAAK9B,IAAL,CAAUgG,QAAV,CAAmBvB,CAApD;AACH;;AACD,gBAAI,CAAC,KAAKgE,MAAN,IAAgB,KAAKpG,cAAL,IAAuB,KAAKvC,IAAL,CAAUwC,KAArD,EAA4D;AACxD,qBAAO,KAAKR,kBAAL,GAA0B,KAAK9B,IAAL,CAAUgG,QAAV,CAAmBvB,CAApD;AACH;;AACD,gBAAI,KAAK1C,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,kBAAI,KAAKiB,WAAL,IAAoB,KAAKjC,SAAL,GAAiB,CAAzC,EAA4C;AACxC,uBAAO,MAAM,KAAKkK,cAAlB;AACH;AACJ,aAJD,MAIO;AACH,kBAAI,KAAKhI,WAAL,IAAoB,CAAxB,EAA2B;AACvB,uBAAO,KAAK8H,cAAZ;AACH;AACJ;;AACD,mBAAO,CAAP;AACH;AACD;;;;eACA,eAAiC;AAC7B,gBAAI,CAAC,KAAKtJ,QAAV,EAAoB,OAAO,CAAP;;AACpB,gBAAI,KAAKjC,UAAT,EAAqB;AACjB,kBAAI,KAAKiL,eAAL,IAAwBtL,eAAe,CAACuL,MAA5C,EAAoD;AAChD,uBAAO,KAAKsC,oBAAZ;AACH;;AACD,qBAAO,CAAP;AACH;;AACD,gBAAI,KAAKpJ,UAAT,EAAqB;AACjB,kBAAI,KAAK4E,MAAT,EAAiB,OAAO,CAAP;AACjB,qBAAO,KAAK3G,kBAAL,GAA0B,KAAK9B,IAAL,CAAUgG,QAAV,CAAmB9B,CAApD;AACH;;AACD,gBAAI,CAAC,KAAKuE,MAAN,IAAgB,KAAKtG,eAAL,IAAwB,KAAKrC,IAAL,CAAUsC,MAAtD,EAA8D;AAC1D,qBAAO,KAAKN,kBAAL,GAA0B,KAAK9B,IAAL,CAAUgG,QAAV,CAAmB9B,CAApD;AACH;;AACD,gBAAI,KAAKvC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,kBAAI,KAAKqB,WAAL,IAAoB,KAAKjC,SAAL,GAAiB,CAAzC,EAA4C;AACxC,uBAAO,KAAKkK,cAAZ;AACH;AACJ,aAJD,MAIO;AACH,kBAAI,KAAKhI,WAAL,IAAoB,CAAxB,EAA2B;AACvB,uBAAO,KAAK8H,cAAZ;AACH;AACJ;;AACD,mBAAO,CAAP;AACH;AACD;;;;eACA,eAA8B;AAC1B,gBAAI,CAAC,KAAKlD,MAAV,EAAkB,OAAO,CAAP;;AAClB,gBAAI,KAAKnG,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,qBAAOuB,IAAI,CAACC,GAAL,CAAS,KAAKe,WAAL,CAAiB,KAAK2D,MAAtB,CAAT,IAA0C3E,IAAI,CAACC,GAAL,CAAS,KAAKmB,WAAL,CAAiB,KAAKkE,MAAtB,CAAT,CAAjD;AACH,aAFD,MAEO;AACH,qBAAOtF,IAAI,CAACC,GAAL,CAAS,KAAKmB,WAAL,CAAiB,KAAKuD,MAAtB,CAAT,IAA0C3E,IAAI,CAACC,GAAL,CAAS,KAAKe,WAAL,CAAiB,KAAKsE,MAAtB,CAAT,CAAjD;AACH;AACJ;AACD;;;;eACA,eAA6B;AACzB,gBAAI,CAAC,KAAKX,MAAV,EAAkB,OAAO,CAAP;;AAClB,gBAAI,KAAK/F,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,qBAAOmB,IAAI,CAACC,GAAL,CAAS,KAAKsB,WAAL,CAAiB,KAAKoD,MAAtB,CAAT,IAA0C3E,IAAI,CAACC,GAAL,CAAS,KAAKwB,WAAL,CAAiB,KAAK6D,MAAtB,CAAT,CAAjD;AACH,aAFD,MAEO;AACH,qBAAOtF,IAAI,CAACC,GAAL,CAAS,KAAKwB,WAAL,CAAiB,KAAKkD,MAAtB,CAAT,IAA0C3E,IAAI,CAACC,GAAL,CAAS,KAAKsB,WAAL,CAAiB,KAAK+D,MAAtB,CAAT,CAAjD;AACH;AACJ;AACD;;;;eACA,eAAwB;AACpB,gBAAI,KAAKzI,IAAL,CAAU6C,QAAV,CAAmBc,MAAnB,IAA6B,CAAjC,EAAoC,OAAO,KAAK7D,IAAL,CAAUC,WAAjB;AACpC,gBAAIpB,IAAI,GAAG,IAAIF,IAAJ,CAAS,KAAKqB,IAAL,CAAUC,WAAV,CAAsBuC,KAA/B,EAAsC,KAAKxC,IAAL,CAAUC,WAAV,CAAsBqC,MAA5D,CAAX;;AACA,gBAAI,KAAKV,QAAT,EAAmB;AACf,kBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnEjD,gBAAAA,IAAI,CAACyD,MAAL,GAAc,KAAK4I,cAAL,GAAsB,CAAC,KAAKE,cAA5B,GAA6C,KAAK5G,UAAlD,GAA+D,KAAKE,aAAlF;AACH,eAFD,MAEO;AACH7F,gBAAAA,IAAI,CAACyD,MAAL,GAAc,KAAK8I,cAAL,GAAsB,CAAC,KAAKF,cAA5B,GAA6C,KAAK1G,UAAlD,GAA+D,KAAKE,aAAlF;AACH;AACJ,aAND,MAMO;AACH,kBAAI,KAAKzC,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvErD,gBAAAA,IAAI,CAAC2D,KAAL,GAAa,KAAK4I,cAAL,GAAsB,CAAC,KAAKF,cAA5B,GAA6C,KAAKrG,WAAlD,GAAgE,KAAKE,YAAlF;AACH,eAFD,MAEO;AACHlG,gBAAAA,IAAI,CAAC2D,KAAL,GAAa,KAAK0I,cAAL,GAAsB,CAAC,KAAKE,cAA5B,GAA6C,KAAKvG,WAAlD,GAAgE,KAAKE,YAAlF;AACH;AACJ;;AACD,gBAAIlG,IAAI,CAAC2D,KAAL,GAAa,KAAKxC,IAAL,CAAUC,WAAV,CAAsBuC,KAAvC,EAA8C;AAC1C3D,cAAAA,IAAI,CAAC2D,KAAL,GAAa,KAAKxC,IAAL,CAAUC,WAAV,CAAsBuC,KAAnC;AACH;;AACD,gBAAI3D,IAAI,CAACyD,MAAL,GAAc,KAAKtC,IAAL,CAAUC,WAAV,CAAsBqC,MAAxC,EAAgD;AAC5CzD,cAAAA,IAAI,CAACyD,MAAL,GAAc,KAAKtC,IAAL,CAAUC,WAAV,CAAsBqC,MAApC;AACH;;AACD,mBAAOzD,IAAP;AACH;;;;AAGD;AACA,yBAA6B;AAAE,mBAAO,KAAK2J,eAAZ;AAA6B;;;;AAE5D;AACA,yBAAwB;AAAE,mBAAO,KAAKrH,UAAZ;AAAwB;;;;AAGlD;AACA,yBAA2B;AACvB,gBAAI,CAAC,KAAKiM,eAAV,EAA2B;AACvB,mBAAKA,eAAL,GAAuB,IAAI7O,IAAJ,EAAvB;;AACA,kBAAI,KAAKoB,UAAT,EAAqB;AACjB,oBAAI,KAAKsN,UAAT,EAAqB;AAAA;;AACjB,sBAAIjI,QAAQ,4BAAG,KAAKiI,UAAL,CAAgBI,MAAnB,oFAAG,sBAAwB/I,QAAxB,CAAiCC,eAApC,2DAAG,uBAAkDU,qBAAlD,CAAwE,KAAKgI,UAAL,CAAgB/G,QAAxF,CAAf;AACA,uBAAKkH,eAAL,GAAuB,KAAKpN,IAAL,CAAUmF,oBAAV,CAA+BH,QAA/B,CAAvB;AACH;AACJ,eALD,MAKO;AACH,oBAAI,KAAKpD,QAAT,EAAmB;AACf,sBAAI,KAAKC,qBAAL,IAA8BzC,qBAAqB,CAAC0C,aAAxD,EAAuE;AACnE,yBAAKsL,eAAL,CAAqBhJ,CAArB,GAAyB,KAAKrC,kBAA9B;AACH,mBAFD,MAEO;AACH,yBAAKqL,eAAL,CAAqBhJ,CAArB,GAAyB,KAAKpC,kBAA9B;AACH;AACJ,iBAND,MAMO;AACH,sBAAI,KAAKC,uBAAL,IAAgC5C,uBAAuB,CAAC6C,aAA5D,EAA2E;AACvE,yBAAKkL,eAAL,CAAqBzI,CAArB,GAAyB,KAAK5C,kBAA9B;AACH,mBAFD,MAEO;AACH,yBAAKqL,eAAL,CAAqBzI,CAArB,GAAyB,KAAK3C,kBAA9B;AACH;AACJ;AACJ;AACJ;;AACD,mBAAO,KAAKoL,eAAZ;AACH;;;;QAjY4BnP,S;;;;;;;;;;;;;;;iBAGgBkB,IAAI,CAAC2N,Q;;;;;;;iBACiB1N,qBAAqB,CAAC0C,a;;;;;;;iBAClBzC,uBAAuB,CAAC6C,a;;;;;;;iBAC1B,C;;;;;;;iBACR,C;;;;;;;iBACT,C;;;;;;;iBACG,C;;;;;;;iBACF,C;;;;;;;iBACC,C;;;;;;;iBACJ,C;;;;;;;iBACA,C;;;;;;;iBACY,K;;;;;;;iBACL,K;;;;;;;iBACA,K;;;;;;;;;;;;iBAEG,E;;;;;;;iBACL,K;;;;;;;iBAI/B,C;;;;;;;;;;;;iBAUA,IAAItD,IAAJ,CAAS,EAAT,EAAa,EAAb,C","sourcesContent":["/*\n * @Author: steveJobs\n * @Email: icipiqkm@gmail.com\n * @Date: 2021-8-1 01:15:04\n * @Last Modified by: steveJobs\n * @Last Modified time: 2021-8-1 14:35:43\n * @Description: 微信 icipiqkm\n */\nimport { _decorator, Component, Node, ccenum, UITransform, SystemEventType, director, Vec3, EventHandler, instantiate, Prefab, Size, Vec2, size } from 'cc';\nimport { SuperScrollview } from './super-scrollview';\nconst { ccclass, property, requireComponent } = _decorator;\nconst EPSILON = 1e-4\nenum Type {\n    HORIZONTAL = 0,\n    VERTICAL = 1,\n}\nccenum(Type)\nenum VerticalAxisDirection {\n    TOP_TO_BOTTOM = 0,\n    BOTTOM_TO_TOP = 1\n}\nccenum(VerticalAxisDirection)\nenum HorizontalAxisDirection {\n    LEFT_TO_RIGHT = 0,\n    RIGHT_TO_LEFT = 1\n}\nccenum(HorizontalAxisDirection)\nenum ScrollDirection {\n    NONE = 0,\n    HEADER = 1,\n    FOOTER = 2,\n}\n@ccclass('SuperLayout')\n@requireComponent(UITransform)\nexport class SuperLayout extends Component {\n    @property(SuperScrollview) scrollView!: SuperScrollview\n    @property(UITransform) view!: UITransform\n    @property({ type: Type }) layoutType: Type = Type.VERTICAL\n    @property({ type: VerticalAxisDirection }) verticalAxisDirection = VerticalAxisDirection.TOP_TO_BOTTOM\n    @property({ type: HorizontalAxisDirection }) horizontalAxisDirection = HorizontalAxisDirection.LEFT_TO_RIGHT\n    @property({ tooltip: \"最小值=1，大于1就是Grid模式\" }) groupItemTotal: number = 1\n    @property({ tooltip: \"决定最多创建Prefab的数量\" }) multiple: number = 2\n    @property({ tooltip: \"顶部填充\" }) paddingTop: number = 0\n    @property({ tooltip: \"底部填充\" }) paddingBottom: number = 0\n    @property({ tooltip: \"左侧填充\" }) paddingLeft: number = 0\n    @property({ tooltip: \"右侧填充\" }) paddingRight: number = 0\n    @property({ tooltip: \"横轴间距\" }) spacingX: number = 0\n    @property({ tooltip: \"纵轴间距\" }) spacingY: number = 0\n    @property({ tooltip: \"计算缩放后的尺寸\" }) affectedByScale: boolean = false\n    @property({ tooltip: \"上/左 无限循环\" }) headerLoop: boolean = false\n    @property({ tooltip: \"下/右 无限循环\" }) footerLoop: boolean = false\n    @property(Prefab) prefab!: Prefab\n    @property(EventHandler) refreshItemEvents: EventHandler[] = []\n    @property({ tooltip: \"开启自动居中\" }) autoCenter: boolean = false\n    @property({\n        tooltip: \"自动居中的滚动时间\",\n        visible: function () { return (this as any).autoCenter }\n    }) centerTime: number = 1\n    @property({\n        type: Node,\n        tooltip: \"自动居中的参考节点，如果为空、则默认选择View中心\",\n        visible: function () { return (this as any).autoCenter }\n    }) centerNode!: Node\n    @property({\n        type: Vec2,\n        tooltip: \"自动居中时、Item的居中锚点\",\n        visible: function () { return (this as any).autoCenter }\n    }) centerAnchor: Vec2 = new Vec2(.5, .5)\n    /** 当前滚动方向 */\n    private scrollDirection: ScrollDirection = ScrollDirection.NONE\n    /** 是否垂直滚动 */\n    get vertical(): boolean { return this.layoutType == Type.VERTICAL }\n    /** 是否水平滚动 */\n    get horizontal(): boolean { return this.layoutType == Type.HORIZONTAL }\n    get transform(): UITransform | null { return this.node._uiProps.uiTransformComp }\n    /** View 可容纳的宽度 */\n    get accommodWidth() {\n        return this.view.width - this.paddingLeft - this.paddingRight\n    }\n    /** View 可容纳的高度 */\n    get accommodHeight() {\n        return this.view.height - this.paddingTop - this.paddingBottom\n    }\n    /** 头部的节点 */\n    get header(): UITransform | null {\n        if (this.node.children.length == 0) return null\n        return this.node.children[0]._uiProps.uiTransformComp\n    }\n    /** 底部的节点 */\n    get footer(): UITransform | null {\n        if (this.node.children.length == 0) return null\n        return this.node.children[this.node.children.length - 1]._uiProps.uiTransformComp\n    }\n    /** 头部索引 */\n    get headerIndex(): number {\n        if (!this.header) return -1\n        let node: any = this.header.node\n        return node[\"__index\"]\n    }\n    /** 底部索引 */\n    get footerIndex(): number {\n        if (!this.footer) return -1\n        let node: any = this.footer.node\n        return node[\"__index\"]\n    }\n    /** Item起始位置 */\n    get viewStartPoint(): Vec3 {\n        let pos = new Vec3()\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            pos.x = this.view.width * -0.5 + this.paddingLeft\n        } else {\n            pos.x = this.view.width * 0.5 - this.paddingRight\n        }\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            pos.y = this.view.height * 0.5 - this.paddingTop\n        } else {\n            pos.y = this.view.height * -0.5 + this.paddingBottom\n        }\n        return pos\n    }\n    /** View 头部边界 */\n    get viewHeaderBoundary(): number {\n        var offset = 0\n        if (this.vertical) {\n            offset = this.view.height * 0.5\n        } else {\n            offset = this.view.width * -0.5\n        }\n        return offset\n    }\n    /** View 底部边界 */\n    get viewFooterBoundary(): number {\n        var offset = 0\n        if (this.vertical) {\n            offset = this.view.height * -0.5\n        } else {\n            offset = this.view.width * 0.5\n        }\n        return offset\n    }\n    /** 头部节点边界 */\n    get headerBoundary(): number {\n        if (!this.header) return 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                return this.node.position.y + this.getItemYMax(this.header) + this.paddingTop\n            } else {\n                return this.node.position.y + this.getItemYMin(this.header) - this.paddingBottom\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                return this.node.position.x + this.getItemXMin(this.header) - this.paddingLeft\n            } else {\n                return this.node.position.x + this.getItemXMax(this.header) + this.paddingRight\n            }\n        }\n    }\n    /** 底部节点边界 */\n    get footerBoundary(): number {\n        if (!this.footer) return 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                return this.node.position.y + this.getItemYMin(this.footer) - this.paddingBottom\n            } else {\n                return this.node.position.y + this.getItemYMax(this.footer) + this.paddingTop\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                return this.node.position.x + this.getItemXMax(this.footer) + this.paddingRight\n            } else {\n                return this.node.position.x + this.getItemXMin(this.footer) - this.paddingLeft\n            }\n        }\n    }\n    /** 自动居中节点头部边界 */\n    get centerHeaderBoundary() {\n        let key = this.vertical ? \"y\" : \"x\"\n        if (this.centerNode) {\n            if (this.vertical) {\n                if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                    return this.headerBoundary + (this.viewHeaderBoundary - (this.centerNode.position as any)[key])\n                } else {\n                    return this.footerBoundary + (this.viewHeaderBoundary - (this.centerNode.position as any)[key])\n                }\n            } else {\n                if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                    return this.headerBoundary + (this.viewHeaderBoundary - (this.centerNode.position as any)[key])\n                } else {\n                    return this.footerBoundary + (this.viewHeaderBoundary - (this.centerNode.position as any)[key])\n                }\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                return this.headerBoundary + (this.viewHeaderBoundary - (this.view.node.position as any)[key])\n            } else {\n                return this.footerBoundary + (this.viewHeaderBoundary - (this.view.node.position as any)[key])\n            }\n        }\n    }\n    /** 自动居中节点底部边界 */\n    get centerFooterBoundary() {\n        let key = this.vertical ? \"y\" : \"x\"\n        if (this.centerNode) {\n            if (this.vertical) {\n                if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                    return this.footerBoundary + (this.viewFooterBoundary - (this.centerNode.position as any)[key])\n                } else {\n                    return this.headerBoundary + (this.viewFooterBoundary - (this.centerNode.position as any)[key])\n                }\n            } else {\n                if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                    return this.footerBoundary + (this.viewFooterBoundary - (this.centerNode.position as any)[key])\n                } else {\n                    return this.headerBoundary + (this.viewFooterBoundary - (this.centerNode.position as any)[key])\n                }\n            }\n        } else {\n            if (this.vertical) {\n                if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                    return this.footerBoundary + (this.viewFooterBoundary - (this.view.node.position as any)[key])\n                } else {\n                    return this.headerBoundary + (this.viewFooterBoundary - (this.view.node.position as any)[key])\n                }\n            } else {\n                if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                    return this.footerBoundary + (this.viewFooterBoundary - (this.view.node.position as any)[key])\n                } else {\n                    return this.headerBoundary + (this.viewFooterBoundary - (this.view.node.position as any)[key])\n                }\n            }\n        }\n    }\n    /** 是否超出左侧边界 */\n    get isOfLeftBoundary(): number {\n        if (this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.HEADER) {\n                return this.centerHeaderBoundary\n            }\n            return 0\n        }\n        if (this.headerLoop) {\n            if (this.header) return 0\n            return this.viewHeaderBoundary + this.node.position.x\n        }\n\n        if (!this.header || this.fixedItemWidth <= this.view.width) {\n            return this.viewHeaderBoundary + this.node.position.x\n        }\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        } else {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this, this.footerBoundary\n            }\n        }\n        return 0\n    }\n    /** 是否超出顶部边界 */\n    get isOfTopBoundary(): number {\n        if (!this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.HEADER) {\n                return this.centerHeaderBoundary\n            }\n            return 0\n        }\n        if (this.headerLoop) {\n            if (this.header) return 0\n            return this.viewHeaderBoundary + this.node.position.y\n        }\n        if (!this.header || this.fixedItemHeight <= this.view.height) {\n            return this.viewHeaderBoundary + this.node.position.y\n        }\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        } else {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this.footerBoundary\n            }\n        }\n        return 0\n    }\n    /** 是否超出右侧边界 */\n    get isOfRightBoundary(): number {\n        if (this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.FOOTER) {\n                return this.centerFooterBoundary\n            }\n            return 0\n        }\n        if (this.footerLoop) {\n            if (this.footer) return 0\n            return this.viewFooterBoundary + this.node.position.x\n        }\n        if (!this.footer || this.fixedItemWidth <= this.view.width) {\n            return this.viewFooterBoundary + this.node.position.x\n        }\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this, this.footerBoundary\n            }\n        } else {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        }\n        return 0\n    }\n    /** 是否超出底部边界 */\n    get isOfButtomBoundary(): number {\n        if (!this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.FOOTER) {\n                return this.centerFooterBoundary\n            }\n            return 0\n        }\n        if (this.footerLoop) {\n            if (this.footer) return 0\n            return this.viewFooterBoundary + this.node.position.y\n        }\n        if (!this.footer || this.fixedItemHeight <= this.view.height) {\n            return this.viewFooterBoundary + this.node.position.y\n        }\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this.footerBoundary\n            }\n        } else {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        }\n        return 0\n    }\n    /** 从头部到底部的所有Item高度总和 */\n    get fixedItemHeight(): number {\n        if (!this.header) return 0\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            return Math.abs(this.getItemYMax(this.header)) + Math.abs(this.getItemYMin(this.footer))\n        } else {\n            return Math.abs(this.getItemYMin(this.header)) + Math.abs(this.getItemYMax(this.footer))\n        }\n    }\n    /** 从头部到底部的所有Item宽度总和 */\n    get fixedItemWidth(): number {\n        if (!this.header) return 0\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            return Math.abs(this.getItemXMin(this.header)) + Math.abs(this.getItemXMax(this.footer))\n        } else {\n            return Math.abs(this.getItemXMax(this.header)) + Math.abs(this.getItemXMin(this.footer))\n        }\n    }\n    /** 返回 header到 footer 之间的整体尺寸 如果Item数量不足以撑开View 则返回View尺寸 最小值是View尺寸 */\n    get contentSize(): Size {\n        if (this.node.children.length == 0) return this.view.contentSize\n        let size = new Size(this.view.contentSize.width, this.view.contentSize.height)\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                size.height = this.headerBoundary + -this.footerBoundary + this.paddingTop + this.paddingBottom\n            } else {\n                size.height = this.footerBoundary + -this.headerBoundary + this.paddingTop + this.paddingBottom\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                size.width = this.footerBoundary + -this.headerBoundary + this.paddingLeft + this.paddingRight\n            } else {\n                size.width = this.headerBoundary + -this.footerBoundary + this.paddingLeft + this.paddingRight\n            }\n        }\n        if (size.width < this.view.contentSize.width) {\n            size.width = this.view.contentSize.width\n        }\n        if (size.height < this.view.contentSize.height) {\n            size.height = this.view.contentSize.height\n        }\n        return size\n    }\n    private prevPos: Vec3 = new Vec3(0, 0, 0)\n    private _maxPrefabTotal: number = 0\n    /** 已被创建的Item数量 */\n    get maxPrefabTotal(): number { return this._maxPrefabTotal }\n    private _itemTotal: number = 0\n    /** 数据长度 */\n    get itemTotal(): number { return this._itemTotal }\n    private gener!: Generator\n    private _centerPosition!: Vec3\n    /** 自动居中的参考位置 */\n    get centerPosition(): Vec3 {\n        if (!this._centerPosition) {\n            this._centerPosition = new Vec3()\n            if (this.autoCenter) {\n                if (this.centerNode) {\n                    let worldPos = this.centerNode.parent?._uiProps.uiTransformComp?.convertToWorldSpaceAR(this.centerNode.position)!\n                    this._centerPosition = this.view.convertToNodeSpaceAR(worldPos)\n                }\n            } else {\n                if (this.vertical) {\n                    if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                        this._centerPosition.y = this.viewHeaderBoundary\n                    } else {\n                        this._centerPosition.y = this.viewFooterBoundary\n                    }\n                } else {\n                    if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                        this._centerPosition.x = this.viewHeaderBoundary\n                    } else {\n                        this._centerPosition.x = this.viewFooterBoundary\n                    }\n                }\n            }\n        }\n        return this._centerPosition\n    }\n    onLoad() {\n        this.transform?.setContentSize(this.view.contentSize)\n        this.node.setPosition(Vec3.ZERO)\n        Object.defineProperty(this.transform, \"contentSize\", {\n            configurable: true,\n            get: () => this.contentSize,\n        })\n    }\n    onEnable() {\n        this.addEventListener()\n    }\n    onDisable() {\n        this.removeEventListener()\n    }\n    /** 更新item数量 */\n    async total(count: number) {\n        let created = await this.createItems(count)\n        let offset = count - this.itemTotal\n        this._itemTotal = count\n        if (!created) {\n            this.refreshItems(offset)\n        }\n        this.scrollView.release()\n    }\n    /** 自动居中到最近Item */\n    scrollToCenter() {\n        this.soonFinish()\n    }\n    /** 滚动到头部 */\n    scrollToHeader(timeInSecond?: number) {\n        var headerOrFooter = 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                headerOrFooter = this.viewHeaderBoundary\n            } else {\n                headerOrFooter = this.viewFooterBoundary\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                headerOrFooter = this.viewHeaderBoundary\n            } else {\n                headerOrFooter = this.viewFooterBoundary\n            }\n        }\n        this.scrollToIndex(0, timeInSecond, new Vec3(headerOrFooter, headerOrFooter))\n    }\n    /** 滚动到尾部 */\n    scrollToFooter(timeInSecond?: number) {\n        var headerOrFooter = 0\n        if (this.vertical) {\n            if (this.fixedItemHeight < this.view.height) return\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                headerOrFooter = this.viewFooterBoundary\n            } else {\n                headerOrFooter = this.viewHeaderBoundary\n            }\n        } else {\n            if (this.fixedItemWidth < this.view.width) return\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                headerOrFooter = this.viewFooterBoundary\n            } else {\n                headerOrFooter = this.viewHeaderBoundary\n            }\n        }\n        this.scrollToIndex(this.itemTotal - 1, timeInSecond, new Vec3(headerOrFooter, headerOrFooter), true)\n    }\n    /** 跳转到指定索引位置 */\n    scrollToIndex(index: number, timeInSecond?: number, boundary?: Vec3, reverse: boolean = false) {\n        if (isNaN(index) || index < 0 || index > this.itemTotal - 1) return\n        this.scrollView.stopAutoScroll()\n        var offset = 0\n        var child = this.node.children.find((item: any) => item[\"__index\"] == index)\n        if (!child) {\n            var isDownOffset = false\n            if (index > this.footerIndex && index < this.headerIndex) {\n                if (Math.abs(index - this.headerIndex) < Math.abs(index - this.footerIndex)) {\n                    isDownOffset = false\n                } else {\n                    isDownOffset = true\n                }\n            } else if (index > this.footerIndex) {\n                isDownOffset = true\n            } else if (index < this.headerIndex) {\n                isDownOffset = false\n            }\n            var start = 0\n            if (isDownOffset) {\n                offset = index % this.groupItemTotal - this.footerIndex % this.groupItemTotal\n                offset = Math.abs(offset)\n            } else {\n                offset = this.headerIndex % this.groupItemTotal\n                offset = Math.abs(offset)\n            }\n            for (let i = 0; i < offset; i++) {\n                if (this.vertical) {\n                    if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                        if (isDownOffset) {\n                            this.pushToFooter(true)\n                        } else {\n                            this.pushToHeader(true)\n                        }\n                    } else {\n                        if (isDownOffset) {\n                            this.pushToHeader(true)\n                        } else {\n                            this.pushToFooter(true)\n                        }\n                    }\n                } else {\n                    if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                        if (isDownOffset) {\n                            this.pushToFooter(true)\n                        } else {\n                            this.pushToHeader(true)\n                        }\n                    } else {\n                        if (isDownOffset) {\n                            this.pushToHeader(true)\n                        } else {\n                            this.pushToFooter(true)\n                        }\n                    }\n                }\n            }\n            if (isDownOffset) {\n                start = Math.abs(index - this.maxPrefabTotal) + 1\n            } else {\n                start = index < this.groupItemTotal ? 0 : index\n            }\n            for (let i = 0; i < this.node.children.length; i++) {\n                const child: any = this.node.children[i];\n                if (this.headerLoop || this.footerLoop) {\n                    if (start > this.itemTotal - 1) {\n                        start = 0\n                    }\n                }\n                child[\"__index\"] = start\n                this.notifyRefreshItem(child)\n                start++\n            }\n            child = this.node.children.find((item: any) => item[\"__index\"] == index)\n        }\n        if (!child) return\n        let itemPos = child.getPosition().clone()\n        if (!this.autoCenter) {\n            if (this.vertical) {\n                if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                    if (!reverse) {\n                        itemPos.y = this.getItemYMax(child._uiProps.uiTransformComp!) + this.paddingTop\n                    } else {\n                        itemPos.y = this.getItemYMin(child._uiProps.uiTransformComp!) - this.paddingBottom\n                    }\n                } else {\n                    if (!reverse) {\n                        itemPos.y = this.getItemYMin(child._uiProps.uiTransformComp!) - this.paddingBottom\n                    } else {\n                        itemPos.y = this.getItemYMax(child._uiProps.uiTransformComp!) + this.paddingTop\n                    }\n                }\n            } else {\n                if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                    if (!reverse) {\n                        itemPos.x = this.getItemXMin(child._uiProps.uiTransformComp!) - this.paddingLeft\n                    } else {\n                        itemPos.x = this.getItemXMax(child._uiProps.uiTransformComp!) + this.paddingRight\n                    }\n                } else {\n                    if (!reverse) {\n                        itemPos.x = this.getItemXMax(child._uiProps.uiTransformComp!) + this.paddingRight\n                    } else {\n                        itemPos.x = this.getItemXMin(child._uiProps.uiTransformComp!) - this.paddingLeft\n                    }\n                }\n            }\n        }\n        let worldPos = this.transform?.convertToWorldSpaceAR(itemPos)!\n        let localPos = this.view.convertToNodeSpaceAR(worldPos)\n        let multiple\n        if (!this.autoCenter && boundary) {\n            multiple = boundary\n        } else {\n            multiple = this.getCenterAnchor(child._uiProps.uiTransformComp!, this.centerPosition)\n        }\n        localPos.multiply(new Vec3(-1, -1, 1)).add(multiple)\n        this.scrollView.scrollToAny(localPos, timeInSecond)\n    }\n    /** 根据centerAnchor计算自动居中的真实位置 */\n    protected getCenterAnchor(item: UITransform, center: Vec3) {\n        var pos = center.clone()\n        if (this.vertical) {\n            let anchor = item.height! * this.centerAnchor.y\n            let origin = item.height! * item.anchorY!\n            pos.y -= anchor - origin\n        } else {\n            let anchor = item.width! * this.centerAnchor.x\n            let origin = item.width! * item.anchorX!\n            pos.x += anchor - origin\n        }\n        return pos\n    }\n    /** 滚动即将结束时 跑自动居中的逻辑 */\n    protected soonFinish() {\n        if (!this.autoCenter) return\n        this.scrollView.stopAutoScroll()\n        var findedPos = new Vec3(999999, 999999)\n        for (let i = 0; i < this.node.children.length; i++) {\n            const child = this.node.children[i];\n            let worldPos = this.transform?.convertToWorldSpaceAR(child.position)!\n            let localPos = this.view.convertToNodeSpaceAR(worldPos)\n            let map = { width: false, height: false }\n\n            var multiple = this.getCenterAnchor(child._uiProps.uiTransformComp!, this.centerPosition)\n\n            let newLocalPos = localPos.subtract(multiple)\n            map.width = Math.abs(newLocalPos.x) < Math.abs(findedPos.x)\n            map.height = Math.abs(newLocalPos.y) < Math.abs(findedPos.y)\n            if (this.vertical && map.height) {\n                findedPos = newLocalPos\n            } else if (!this.vertical && map.width) {\n                findedPos = newLocalPos\n            }\n        }\n        findedPos.multiply(new Vec3(-1, -1, 1))\n        this.scrollView.scrollToAny(findedPos, this.centerTime)\n    }\n    /** 根据groupItemTotal和View可容纳的尺寸 来平均分配Item该有的尺寸 */\n    protected getItemSize(item: UITransform): Size {\n        let size = new Size()\n        if (this.vertical) {\n            let spacing = this.spacingX * (this.groupItemTotal - 1)\n            size.width = (this.accommodWidth - spacing) / this.groupItemTotal\n            size.height = item.height\n        } else {\n            let spacing = this.spacingY * (this.groupItemTotal - 1)\n            size.height = (this.accommodHeight - spacing) / this.groupItemTotal\n            size.width = item.width\n        }\n        return size\n    }\n    /** 获取Item的YMax */\n    protected getItemYMax(item: UITransform | null): number {\n        if (!item) return 0\n        let height = this.getScaleHeight(item) * (1 - item.anchorY)\n        return item.node.position.y + height\n    }\n    /** 获取Item的YMin */\n    protected getItemYMin(item: UITransform | null): number {\n        if (!item) return 0\n        let height = this.getScaleHeight(item) * item.anchorY\n        return item.node.position.y - height\n    }\n    /** 获取Item的XMax */\n    protected getItemXMax(item: UITransform | null): number {\n        if (!item) return 0\n        let width = this.getScaleWidth(item) * (1 - item.anchorX)\n        return item.node.position.x + width\n    }\n    /** 获取Item的XMin */\n    protected getItemXMin(item: UITransform | null): number {\n        if (!item) return 0\n        let width = this.getScaleWidth(item) * item.anchorX\n        return item.node.position.x - width\n    }\n    /** 获取一组Item中起始位置X */\n    protected getStartX(item: UITransform | null): number {\n        if (!item) return 0\n        var x = 0\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            let width = this.getScaleWidth(item) * item.anchorX\n            x = this.viewStartPoint.x + width\n        } else {\n            let width = this.getScaleWidth(item) * (1 - item.anchorX)\n            x = this.viewStartPoint.x - width\n        }\n        return x\n    }\n    /** 获取一组Item中结束位置X */\n    protected getEndX(item: UITransform | null): number {\n        if (!item) return 0\n        var x = 0\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            let width = this.getScaleWidth(item) * (1 - item.anchorX)\n            x = -this.viewStartPoint.x - width - this.paddingRight + this.paddingLeft\n        } else {\n            let width = this.getScaleWidth(item) * item.anchorX\n            x = -this.viewStartPoint.x + width + this.paddingLeft - this.paddingRight\n        }\n        return x\n    }\n    /** 获取一组Item中起始位置Y */\n    protected getStartY(item: UITransform | null): number {\n        if (!item) return 0\n        var y = 0\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            let height = this.getScaleHeight(item) * (1 - item.anchorY)\n            y = this.viewStartPoint.y - height\n        } else {\n            let height = this.getScaleHeight(item) * item.anchorY\n            y = this.viewStartPoint.y + height\n        }\n        return y\n    }\n    /** 获取一组Item中结束位置Y */\n    protected getEndY(item: UITransform | null): number {\n        if (!item) return 0\n        var y = 0\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            let height = this.getScaleHeight(item) * item.anchorY\n            y = -this.viewStartPoint.y + height + this.paddingBottom - this.paddingTop\n        } else {\n            let height = this.getScaleHeight(item) * (1 - item.anchorY)\n            y = -this.viewStartPoint.y - height - this.paddingTop + this.paddingBottom\n        }\n        return y\n    }\n    /** relative的顶部是否有也容纳空间 */\n    protected isAccommodateByTop(relative: UITransform) {\n        var max = this.getItemYMax(relative)\n        return max + this.paddingTop < this.accommodHeight * 0.5\n    }\n    /** relative的底部是否有也容纳空间 */\n    protected isAccommodateByBottom(relative: UITransform) {\n        var min = this.getItemYMin(relative)\n        return min - this.paddingBottom > this.accommodHeight * -0.5\n    }\n    /** relative的左侧是否有也容纳空间 */\n    protected isAccommodateByLeft(relative: UITransform) {\n        var min = this.getItemXMin(relative)\n        return min - this.paddingLeft > this.accommodWidth * -0.5\n    }\n    /** relative的右侧是否有也容纳空间 */\n    protected isAccommodateByRight(relative: UITransform) {\n        var max = this.getItemXMax(relative)\n        return max + this.paddingRight < this.accommodWidth * 0.5\n    }\n    /** relative的左侧位置 */\n    protected getRelativeByLeft(item: UITransform, relative: UITransform): number {\n        var min = this.getItemXMin(relative)\n        return min - this.spacingX - this.getScaleWidth(item) * (1 - item.anchorX)\n    }\n    /** relative的右侧位置 */\n    protected getRelativeByRight(item: UITransform, relative: UITransform): number {\n        var max = this.getItemXMax(relative)\n        return max + this.spacingX + this.getScaleWidth(item) * item.anchorX\n    }\n    /** relative的顶部位置 */\n    protected getRelativeByTop(item: UITransform, relative: UITransform): number {\n        var max = this.getItemYMax(relative)\n        return max + this.spacingY + this.getScaleHeight(item) * (1 - item.anchorY)\n    }\n    /** relative的底部位置 */\n    protected getRelativeByBottom(item: UITransform, relative: UITransform): number {\n        var min = this.getItemYMin(relative)\n        return min - this.spacingY - this.getScaleHeight(item) * item.anchorY\n    }\n    /** 设置Item的坐标位置 */\n    protected setItemPosition(item: UITransform, relative: UITransform, reverse: boolean = false) {\n        var pos = new Vec3()\n        if (!this.header) {\n            pos.x = this.getStartX(item)\n            pos.y = this.getStartY(item)\n        } else {\n            if (this.vertical) {\n                pos = this.getVerticalRelativePosition(item, relative, reverse)\n            } else {\n                pos = this.getHorizontalRelativePosition(item, relative, reverse)\n            }\n        }\n        item.node.setPosition(pos)\n    }\n    /** 计算垂直模式的Item应该的位置 */\n    protected getVerticalRelativePosition(item: UITransform, relative: UITransform, reverse: boolean) {\n        var pos = new Vec3()\n        var isAccommodate = false\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            isAccommodate = !reverse ? this.isAccommodateByRight(relative) : this.isAccommodateByLeft(relative)\n        } else {\n            isAccommodate = !reverse ? this.isAccommodateByLeft(relative) : this.isAccommodateByRight(relative)\n        }\n        // 横轴\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (!reverse) {\n                pos.x = isAccommodate ? this.getRelativeByRight(item, relative) : this.getStartX(item)\n            } else {\n                pos.x = isAccommodate ? this.getRelativeByLeft(item, relative) : this.getEndX(item)\n            }\n        } else {\n            if (!reverse) {\n                pos.x = isAccommodate ? this.getRelativeByLeft(item, relative) : this.getStartX(item)\n            } else {\n                pos.x = isAccommodate ? this.getRelativeByRight(item, relative) : this.getEndX(item)\n            }\n        }\n        // 纵轴\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (!reverse) {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByBottom(item, relative)\n            } else {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByTop(item, relative)\n            }\n        } else {\n            if (!reverse) {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByTop(item, relative)\n            } else {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByBottom(item, relative)\n            }\n        }\n        return pos\n    }\n    /** 计算水平模式的Item应该的位置 */\n    protected getHorizontalRelativePosition(item: UITransform, relative: UITransform, reverse: boolean) {\n        var pos = new Vec3()\n        var isAccommodate = false\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            isAccommodate = !reverse ? this.isAccommodateByBottom(relative) : this.isAccommodateByTop(relative)\n        } else {\n            isAccommodate = !reverse ? this.isAccommodateByTop(relative) : this.isAccommodateByBottom(relative)\n        }\n        // 纵轴\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (!reverse) {\n                pos.y = isAccommodate ? this.getRelativeByBottom(item, relative) : this.getStartY(item)\n            } else {\n                pos.y = isAccommodate ? this.getRelativeByTop(item, relative) : this.getEndY(item)\n            }\n        } else {\n            if (!reverse) {\n                pos.y = isAccommodate ? this.getRelativeByTop(item, relative) : this.getStartY(item)\n            } else {\n                pos.y = isAccommodate ? this.getRelativeByBottom(item, relative) : this.getEndY(item)\n            }\n        }\n        // 横轴\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (!reverse) {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByRight(item, relative)\n            } else {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByLeft(item, relative)\n            }\n        } else {\n            if (!reverse) {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByLeft(item, relative)\n            } else {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByRight(item, relative)\n            }\n        }\n        return pos\n    }\n    /** 当数据长度发生变化时 计算item应该怎么排列 */\n    protected refreshItems(offset: number) {\n        if (offset < 0) {\n            for (let i = 0; i < -offset; i++) {\n                if (this.headerLoop) {\n                    this.pushToHeader()\n                } else if (this.footerLoop) {\n                    this.pushToHeader()\n                } else {\n                    this.pushToHeader(true)\n                }\n            }\n            let startIndex = this.headerIndex > 0 ? this.headerIndex : 0\n            for (let i = 0; i < this.node.children.length; i++) {\n                const child: any = this.node.children[i];\n                if (this.headerLoop || this.footerLoop) {\n                    if (startIndex > this.itemTotal - 1) {\n                        startIndex = 0\n                    }\n                }\n                child[\"__index\"] = startIndex\n                this.notifyRefreshItem(child)\n                startIndex++\n            }\n            this.scrollView.startAutoScroll()\n        } else {\n            for (let i = 0; i < this.node.children.length; i++) {\n                if (this.vertical) {\n                    if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                        this.pushToFooter()\n                    } else {\n                        this.pushToHeader()\n                    }\n                } else {\n                    if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                        this.pushToFooter()\n                    } else {\n                        this.pushToHeader()\n                    }\n                }\n            }\n        }\n    }\n    /** 创建Item */\n    protected async createItems(count: number) {\n        this.gener?.return(\"\")\n        // 有多余的item 需要删除 不处理\n        if (this.node.children.length > count) {\n            this.removeItems(count)\n            return false\n        }\n        // 已经固定item总数 不处理\n        if (this._maxPrefabTotal > 0 && this._maxPrefabTotal == this.node.children.length) {\n            return false\n        }\n\n        // 开始分帧创建item\n        let total = count - this.node.children.length //计算当前应该创建的总数\n        this.gener = this.getGeneratorLength(total, () => {\n            let child: any = instantiate(this.prefab)\n            child[\"__index\"] = this.node.children.length\n            const transform = child._uiProps.uiTransformComp\n            transform.setContentSize(this.getItemSize(transform))\n            this.setItemPosition(child._uiProps.uiTransformComp, this.footer!)\n            this.node.addChild(child)\n            this.notifyRefreshItem(child)\n            child[\"__size\"] = transform.contentSize.clone()\n            child[\"__scale\"] = child.getScale().clone()\n            child.on(Node.EventType.SIZE_CHANGED, this.onChildSize, this)\n            child.on(Node.EventType.TRANSFORM_CHANGED, this.onChildScale, this)\n            let selfHorW, viewHorW\n            if (this.vertical) {\n                selfHorW = this.contentSize.height\n                viewHorW = this.view.height\n            } else {\n                selfHorW = this.contentSize.width\n                viewHorW = this.view.width\n            }\n            /**\n             * 根据排列方向 来判断对比宽度还是高度\n             * 这里使用参数this.multiple来判断是否需要继续创建 默认为2倍 比如view可视尺寸为800 2倍就是1600\n             * 根据之前所创建的所有item的尺寸计算是否满足这个尺寸 如果满足则不再继续创建 \n             * 由于是分帧加载 所以下一次创建会等这一次的返回结果 返回false 则终止分帧任务\n             */\n            if (selfHorW >= viewHorW * this.multiple) {\n                this._maxPrefabTotal = this.node.children.length\n                return false\n            }\n            return true\n        })\n        await this.exeGenerator(this.gener, 20) //执行分帧任务 1帧创建10个\n        return true\n    }\n    /** 删除多余的item */\n    protected removeItems(count: number) {\n        // 有多余的item 需要删除\n        let length = this.node.children.length - count\n        // 删除掉多余的item\n        for (let i = 0; i < length; i++) {\n            var child = this.node.children[this.node.children.length - 1]\n            child.off(Node.EventType.SIZE_CHANGED, this.onChildSize, this);\n            child.off(Node.EventType.TRANSFORM_CHANGED, this.onChildScale, this);\n            child.destroy()\n            this.node.removeChild(child)\n        }\n    }\n    protected addEventListener() {\n        this.node.on(SystemEventType.TRANSFORM_CHANGED, this.onPositionChanged, this)\n    }\n    protected removeEventListener() {\n        this.node.off(SystemEventType.TRANSFORM_CHANGED, this.onPositionChanged, this)\n    }\n    /** 当Item缩放改变时 限制并改回该有的缩放 */\n    protected onChildScale(type: any) {\n        if (!this.affectedByScale) return\n        if (type == Node.TransformBit.SCALE) {\n            for (let i = 0; i < this.node.children.length; i++) {\n                const child: any = this.node.children[i];\n                const __scale = child[\"__scale\"]\n                if (this.groupItemTotal == 1) {\n                    if (this.vertical) {\n                        if (child.scale.x != __scale.x) {\n                            console.warn(\"不允许修改Item缩放X\")\n                            child.setScale(new Vec3(__scale.x, child.scale.y))\n                            return\n                        }\n                    } else {\n                        if (child.scale.y != __scale.y) {\n                            console.warn(\"不允许修改Item缩放Y\")\n                            child.setScale(new Vec3(child.scale.y, __scale.y))\n                            return\n                        }\n                    }\n                } else if (this.groupItemTotal > 1) {\n                    if (!child.scale.equals(__scale)) {\n                        console.warn(\"Grid模式不允许修改Item缩放\")\n                        child.setScale(__scale)\n                        return\n                    }\n                }\n            }\n            if (this.groupItemTotal > 1) return\n            this.resetChilds()\n        }\n    }\n    /** 当Item尺寸改变时 限制并改回该有的尺寸 */\n    protected onChildSize() {\n        for (let i = 0; i < this.node.children.length; i++) {\n            const child: any = this.node.children[i];\n            const __size = child[\"__size\"]\n            const transform = child._uiProps.uiTransformComp!\n            if (this.groupItemTotal == 1) {\n                if (this.vertical) {\n                    if (transform?.width != __size.width) {\n                        console.warn(\"不允许修改Item宽度\")\n                        transform.setContentSize(size(__size.width, transform.height))\n                        return\n                    }\n                } else {\n                    if (transform?.height != __size.height) {\n                        console.warn(\"不允许修改Item高度\")\n                        transform.setContentSize(size(transform.width, __size.height))\n                        return\n                    }\n                }\n            } else if (this.groupItemTotal > 1) {\n                if (!transform.contentSize.equals(__size)) {\n                    console.warn(\"Grid模式不允许修改Item尺寸\")\n                    transform.setContentSize(__size)\n                    return\n                }\n            }\n        }\n        if (this.groupItemTotal > 1) return\n        this.resetChilds()\n    }\n    /** 重新计算当前所有Item的位置 */\n    protected resetChilds(start: boolean = false) {\n        var prevItem: any = this.header\n        if (this.vertical && this.fixedItemHeight <= this.view.height || !this.vertical && this.fixedItemWidth <= this.view.width) {\n            let x = this.getStartX(this.header)\n            let y = this.getStartY(this.header)\n            this.header?.node.setPosition(new Vec3(x, y))\n        }\n        if (start) {\n            if (this.vertical) {\n                let x = this.getStartX(this.header)\n                this.header?.node.setPosition(new Vec3(x, this.header.node.position.y))\n            } else {\n                let y = this.getStartY(this.header)\n                this.header?.node.setPosition(new Vec3(this.header.node.position.x, y))\n            }\n        }\n        for (let i = 1; i < this.node.children.length; i++) {\n            const child = this.node.children[i];\n            const transform = child._uiProps.uiTransformComp!\n            let relative = !prevItem ? this.header : prevItem\n            this.setItemPosition(transform, relative)\n            prevItem = transform\n        }\n        this.scrollView.startAutoScroll()\n    }\n    protected getUsedScaleValue(value: number) {\n        return this.affectedByScale ? Math.abs(value) : 1;\n    }\n    protected getScaleWidth(trans: UITransform | null): number {\n        if (!trans) return 0\n        return trans.width * this.getUsedScaleValue(trans.node.scale.x)\n    }\n    protected getScaleHeight(trans: UITransform | null): number {\n        if (!trans) return 0\n        return trans.height * this.getUsedScaleValue(trans.node.scale.y)\n    }\n    protected onPositionChanged() {\n        if (this.vertical) {\n            if (this.scrollView.prevLocation.y < this.scrollView.location.y) {\n                this.scrollDirection = ScrollDirection.FOOTER\n            } else if (this.scrollView.prevLocation.y > this.scrollView.location.y) {\n                this.scrollDirection = ScrollDirection.HEADER\n            } else {\n                this.scrollDirection = ScrollDirection.NONE\n            }\n        } else {\n            if (this.scrollView.prevLocation.x > this.scrollView.location.x) {\n                this.scrollDirection = ScrollDirection.FOOTER\n            } else if (this.scrollView.prevLocation.x < this.scrollView.location.x) {\n                this.scrollDirection = ScrollDirection.HEADER\n            } else {\n                this.scrollDirection = ScrollDirection.NONE\n            }\n        }\n\n        if (this.vertical) {\n            for (let i = 0; i < this.node.children.length; i++) {\n                let isOfBoundary = Math.abs(this.prevPos.y - this.node.position.y) > EPSILON\n                if (!isOfBoundary) continue\n                if (this.prevPos.y < this.node.position.y) {\n                    this.pushToFooter()\n                } else if (this.prevPos.y > this.node.position.y) {\n                    this.pushToHeader()\n                }\n            }\n        } else {\n            for (let i = 0; i < this.node.children.length; i++) {\n                let isOfBoundary = Math.abs(this.prevPos.x - this.node.position.x) > EPSILON\n                if (!isOfBoundary) continue\n                if (this.prevPos.x > this.node.position.x) {\n                    this.pushToFooter()\n                } else if (this.prevPos.x < this.node.position.x) {\n                    this.pushToHeader()\n                }\n            }\n        }\n        this.prevPos = this.node.position.clone()\n    }\n    /** 向尾部填充 force如果为true 则强制填充 */\n    protected pushToFooter(force: boolean = false) {\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                if (force || this.headerBoundary - this.paddingTop > this.viewHeaderBoundary + this.header?.height!) {\n                    this.pushToFooterHandler()\n                }\n            } else {\n                if (force || this.footerBoundary - this.paddingTop > this.viewHeaderBoundary + this.header?.height!) {\n                    this.pushToHeaderHandler()\n                }\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                if (force || this.headerBoundary + this.paddingLeft < this.viewHeaderBoundary - this.header?.width!) {\n                    this.pushToFooterHandler()\n                }\n            } else {\n                if (force || this.footerBoundary + this.paddingLeft < this.viewHeaderBoundary - this.header?.width!) {\n                    this.pushToHeaderHandler()\n                }\n            }\n        }\n    }\n    /** 向头部填充 force如果为true 则强制填充 */\n    protected pushToHeader(force: boolean = false) {\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                if (force || this.footerBoundary + this.paddingBottom < this.viewFooterBoundary - this.footer?.height!) {\n                    this.pushToHeaderHandler()\n                }\n            } else {\n                if (force || this.headerBoundary + this.paddingBottom < this.viewFooterBoundary - this.footer?.height!) {\n                    this.pushToFooterHandler()\n                }\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                if (force || this.footerBoundary - this.paddingRight > this.viewFooterBoundary + this.footer?.width!) {\n                    this.pushToHeaderHandler()\n                }\n            } else {\n                if (force || this.headerBoundary - this.paddingRight > this.viewFooterBoundary + this.footer?.width!) {\n                    this.pushToFooterHandler()\n                }\n            }\n        }\n    }\n    protected pushToFooterHandler() {\n        var node: any = this.header?.node\n        if (this.footerLoop) {\n            if (this.footerIndex >= this.itemTotal - 1) {\n                node[\"__index\"] = 0\n            } else {\n                node[\"__index\"] = this.footerIndex + 1\n            }\n        } else {\n            if (!this.footer || this.footerIndex >= this.itemTotal - 1) return\n            node[\"__index\"] = this.footerIndex + 1\n        }\n        this.notifyRefreshItem(node)\n        this.setItemPosition(this.header!, this.footer!)\n        this.header?.node.setSiblingIndex(this.node.children.length)\n    }\n    protected pushToHeaderHandler() {\n        var node: any = this.footer?.node\n        if (this.headerLoop) {\n            if (this.headerIndex == 0) {\n                node[\"__index\"] = this.itemTotal - 1\n            } else {\n                node[\"__index\"] = this.headerIndex - 1\n            }\n        } else {\n            if (!this.header || this.headerIndex == 0) return\n            node[\"__index\"] = this.headerIndex - 1\n        }\n        this.notifyRefreshItem(node)\n        this.setItemPosition(this.footer!, this.header!, true)\n        this.footer?.node.setSiblingIndex(0)\n        // 对其头部\n        if (!this.headerLoop && this.headerIndex == 0) {\n            // 判断是否是起始位置\n            let accommodate = this.isAccommodateByLeft(this.header!)\n            if (accommodate) {\n                this.resetChilds(true)\n            }\n        }\n    }\n    /** 通知给定的node刷新数据 */\n    protected notifyRefreshItem(target: Node) {\n        EventHandler.emitEvents(this.refreshItemEvents, target, (target as any)['__index'])\n    }\n    /** 分帧加载 */\n    protected * getGeneratorLength(length: number, callback: Function, ...params: any): Generator {\n        for (let i = 0; i < length; i++) {\n            let result = callback(i, ...params)\n            if (result) {\n                yield\n            } else {\n                return\n            }\n        }\n    }\n    /** 分帧执行 */\n    protected exeGenerator(generator: Generator, duration: number) {\n        return new Promise((resolve, reject) => {\n            let gen = generator\n            let execute = () => {\n                let startTime = new Date().getTime()\n                for (let iter = gen.next(); ; iter = gen.next()) {\n                    if (iter == null || iter.done) {\n                        resolve(null)\n                        return\n                    }\n                    if (new Date().getTime() - startTime > duration) {\n                        setTimeout(() => execute(), director.getDeltaTime())\n                        return\n                    }\n                }\n            }\n            execute()\n        })\n    }\n}"]}